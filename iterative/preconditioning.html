
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>34. Preconditioning &#8212; Introduction to Scientific Computing</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'iterative/preconditioning';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="36. The Chebyshev Method" href="Chebyshev.html" />
    <link rel="prev" title="33. The Gradient Method" href="gradientmethod.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/ASC_Logo_transparent_300ppi_RGB.png" class="logo__image only-light" alt="Introduction to Scientific Computing - Home"/>
    <script>document.write(`<img src="../_static/ASC_Logo_transparent_300ppi_RGB.png" class="logo__image only-dark" alt="Introduction to Scientific Computing - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    An Interactive Introduction to the Finite Element Method
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">The Galerkin Method</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../primal/first_example.html">1. Solving the Poisson Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../primal/boundary_conditions.html">2. Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../primal/subdomains.html">3. Variable Coefficients</a></li>
<li class="toctree-l1"><a class="reference internal" href="../primal/elasticity3D.html">4. 3D Solid Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../primal/solvers.html">5. Iterative Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../primal/exercises.html">6. Exercises</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Abstract Theory</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../abstracttheory/BasicProperties.html">7. Basic properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="../abstracttheory/subspaceprojection.html">8. Projection onto subspaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../abstracttheory/RieszRepresentation.html">9. Riesz representation theorem and symmetric variational problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../abstracttheory/Coercive.html">10. Coercive variational problems and their approximation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Mixed Finite Element Methods</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../mixed/stokes.html">11. Stokes Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mixed/boundary.html">12. Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mixed/secondorder.html">13. Mixed Methods for second order equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mixed/abstract.html">14. Abstract Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mixed/abstractfem.html">15. Abstract theory for mixed finite element methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mixed/pardep.html">16. Parameter Dependent Problems</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Discontinuous Galerkin Methods</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../DG/stationary.html">17. Stationary Transport Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DG/instationary.html">18. Instationary Transport Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DG/Nitsche.html">19. Nitsche’s Method for boundary and interface conditions</a></li>

<li class="toctree-l1"><a class="reference internal" href="../DG/elliptic.html">21. Hybrid DG for elliptic equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DG/splitting.html">22. Splitting Methods for the time-dependent convection diffusion equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DG/fourthorder.html">23. Fourth Order Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DG/stokes.html">24. H(div)-conforming Stokes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Mixed Methods for Second Order Equations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../secondorder/framework.html">25. Application of the abstract theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../secondorder/hdiv.html">26. The function space <span class="math notranslate nohighlight">\(H(\operatorname{div})\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../secondorder/finiteelements.html">27. Finite Elements in <span class="math notranslate nohighlight">\(H(\operatorname{div})\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../secondorder/erroranalysis.html">28. Finite Element Error Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../secondorder/erroranalysisl2h1.html">29. Error Analysis in <span class="math notranslate nohighlight">\(L_2 \times H^1\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../secondorder/hybridization.html">30. Hybridization Techniques</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Iteration Methods</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="simple.html">31. Basic Iterative Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="Richardson.html">32. The Richardson Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="gradientmethod.html">33. The Gradient Method</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">34. Preconditioning</a></li>

<li class="toctree-l1"><a class="reference internal" href="Chebyshev.html">36. The Chebyshev Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="conjugategradients.html">37. Conjugate Gradients</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/iterative/preconditioning.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Preconditioning</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">34. Preconditioning</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-preconditioned-richardson-iteration">34.1. The preconditioned Richardson iteration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-preconditioned-gradient-method">34.2. The preconditioned gradient method</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#jacobi-and-gauss-seidel-preconditioners">35. Jacobi and Gauss Seidel Preconditioners</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="preconditioning">
<h1><span class="section-number">34. </span>Preconditioning<a class="headerlink" href="#preconditioning" title="Link to this heading">#</a></h1>
<p>We call <span class="math notranslate nohighlight">\(C\)</span> a preconditioner to the matrix <span class="math notranslate nohighlight">\(A\)</span> if</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(C^{-1} A \approx I\)</span></p></li>
<li><p>the matrix-vector multiplication <span class="math notranslate nohighlight">\(w = C^{-1} r\)</span> is cheap</p></li>
</ul>
<p>One extreme case is <span class="math notranslate nohighlight">\(C = A\)</span>, where the first claim is optimally satisfied, but (in general) not the second. The opposite extreme is <span class="math notranslate nohighlight">\(C = I\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(A\)</span> is an SPD matrix, we like to have an SPD preconditioner <span class="math notranslate nohighlight">\(C\)</span>. In this case, the quality of the approximation can be measured by the spectral bounds</p>
<div class="math notranslate nohighlight">
\[
0 &lt; \gamma_1 \leq \frac{x^T A x }{x^T C x} \leq \gamma_2 \qquad \forall \, 0 \neq x \in {\mathbb R^n}
\]</div>
<p>The Rayleigh quotient is bounded by <span class="math notranslate nohighlight">\(\gamma_1\)</span> and <span class="math notranslate nohighlight">\(\gamma_2\)</span> from below and from above.
These spectral bounds are bounds for the eigenvalues <span class="math notranslate nohighlight">\(\lambda\)</span> of the generalized eigenvalue problem</p>
<div class="math notranslate nohighlight">
\[
A x = \lambda C x
\]</div>
<p>If <span class="math notranslate nohighlight">\(\lambda_i\)</span> is an eigenvalue with eigenvector <span class="math notranslate nohighlight">\(x_i\)</span>, then <span class="math notranslate nohighlight">\(x_i^T A x_i = \lambda_i x_i^T C x_i\)</span>, and thus <span class="math notranslate nohighlight">\(\lambda_i \in [\gamma_1, \gamma_2]\)</span></p>
<section id="the-preconditioned-richardson-iteration">
<h2><span class="section-number">34.1. </span>The preconditioned Richardson iteration<a class="headerlink" href="#the-preconditioned-richardson-iteration" title="Link to this heading">#</a></h2>
<p>We use the preconditioner to obtain the correction from the residuum:</p>
<div class="math notranslate nohighlight">
\[
\qquad  x^{k+1} = x^k - \alpha C^{-1} (b - A x^k)
\]</div>
<p>The error is now propagated as</p>
<div class="math notranslate nohighlight">
\[
e^{k+1} = M e^k = (I - \alpha C^{-1} A) e^k
\]</div>
<p>If we could use the ideal preconditioner <span class="math notranslate nohighlight">\(C = A\)</span>, and set <span class="math notranslate nohighlight">\(\alpha = 1\)</span>, then <span class="math notranslate nohighlight">\(M = 0\)</span>, and we converge in one iteration.</p>
<p>The error-propagation matrix <span class="math notranslate nohighlight">\(M\)</span> is self-adjoint in the energy inner product</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
\left&lt; M x, y \right&gt;_A &amp; = &amp; (A M x)^T y \\
&amp; = &amp; \left\{ A (x - \alpha C^{-1} A x) \right\}^T y  \\
&amp; = &amp; x^T (A - \alpha A C^{-1} A) y \\
&amp; = &amp; \left&lt; x, M y \right&gt;_A
\end{eqnarray*}\]</div>
<p>as well as in the inner products</p>
<div class="math notranslate nohighlight">
\[
\left&lt; x, y \right&gt;_C \qquad \text{and} \qquad \left&lt; x, y \right&gt;_{AC^{-1} A}.
\]</div>
<p>The error is monotonically decreased in the corresponding norms. In particular the last one is practically interesting since it is computationally available:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
\| x - x^\ast \|_{AC^{-1} A}^2 &amp; = &amp; \| A (x - x^\ast) \|_{C^{-1}}^2 \\
&amp; = &amp; \| A x - b \|_{C^{-1}}^2
\end{eqnarray*}\]</div>
<p>With the residuum <span class="math notranslate nohighlight">\(r\)</span> and preconditioned residuum <span class="math notranslate nohighlight">\(w\)</span>, i.e.</p>
<div class="math notranslate nohighlight">
\[
r = b - A x \qquad \text{and} \qquad w = C^{-1} r
\]</div>
<p>the error becomes</p>
<div class="math notranslate nohighlight">
\[
\| x - x^\ast \|_{AC^{-1}A}^2 = r^T w
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ngsolve</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">netgen.geom2d</span> <span class="kn">import</span> <span class="n">unit_square</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="p">(</span><span class="n">unit_square</span><span class="o">.</span><span class="n">GenerateMesh</span><span class="p">(</span><span class="n">maxh</span><span class="o">=</span><span class="mf">0.1</span><span class="p">))</span>
<span class="n">fes</span> <span class="o">=</span> <span class="n">H1</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">fes</span><span class="o">.</span><span class="n">TnT</span><span class="p">()</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">BilinearForm</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="n">grad</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">dx</span><span class="p">)</span><span class="o">.</span><span class="n">Assemble</span><span class="p">()</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">LinearForm</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">v</span><span class="o">*</span><span class="n">dx</span><span class="p">)</span><span class="o">.</span><span class="n">Assemble</span><span class="p">()</span>
<span class="n">gfu</span> <span class="o">=</span> <span class="n">GridFunction</span><span class="p">(</span><span class="n">fes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>A very simple preconditioner is the Jacobi-preconditioner</p>
<div class="math notranslate nohighlight">
\[
C = \text{diag} A
\]</div>
<p>If <span class="math notranslate nohighlight">\(A\)</span> is SPD, then all diagonal entries are positive, and <span class="math notranslate nohighlight">\(C\)</span> is SPD as well.</p>
<p>In NGSolve, we can obtain a Jacobi preconditioner as follows. The result is a linear operator providing the linear operation</p>
<div class="math notranslate nohighlight">
\[
w := C^{-1} * r
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pre</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">CreateSmoother</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hv</span> <span class="o">=</span> <span class="n">gfu</span><span class="o">.</span><span class="n">vec</span><span class="o">.</span><span class="n">CreateVector</span><span class="p">()</span>
<span class="n">hv2</span> <span class="o">=</span> <span class="n">gfu</span><span class="o">.</span><span class="n">vec</span><span class="o">.</span><span class="n">CreateVector</span><span class="p">()</span>
<span class="n">hv3</span> <span class="o">=</span> <span class="n">gfu</span><span class="o">.</span><span class="n">vec</span><span class="o">.</span><span class="n">CreateVector</span><span class="p">()</span>
<span class="n">hv</span><span class="o">.</span><span class="n">SetRandom</span><span class="p">()</span>
<span class="n">hv</span><span class="o">.</span><span class="n">data</span> <span class="o">/=</span> <span class="n">Norm</span><span class="p">(</span><span class="n">hv</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">hv2</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">mat</span> <span class="o">*</span> <span class="n">hv</span>
    <span class="n">hv3</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">pre</span> <span class="o">*</span> <span class="n">hv2</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">Norm</span><span class="p">(</span><span class="n">hv3</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">rho</span><span class="p">)</span>
    <span class="n">hv</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">rho</span> <span class="o">*</span> <span class="n">hv3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5171931697591334
1.3152154363699025
1.3884418540700882
1.4255565966417438
1.4503887120065306
1.4692222071178436
1.4847779137698838
1.4985352524895612
1.5113639459310553
1.5237634745450535
1.5359821935411
1.54809072950813
1.5600362039450506
1.5716880990340865
1.5828790940052835
1.5934400794601162
1.603226978758533
1.6121375156014908
1.6201177805380806
1.627160276636046
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">rho</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">vec</span><span class="o">.</span><span class="n">CreateVector</span><span class="p">()</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">vec</span><span class="o">.</span><span class="n">CreateVector</span><span class="p">()</span>
<span class="n">gfu</span><span class="o">.</span><span class="n">vec</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">w</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">pre</span> <span class="o">*</span> <span class="n">f</span><span class="o">.</span><span class="n">vec</span>
<span class="n">err0</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">InnerProduct</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">vec</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
<span class="n">its</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">r</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">vec</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">mat</span> <span class="o">*</span> <span class="n">gfu</span><span class="o">.</span><span class="n">vec</span>
    <span class="n">w</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">pre</span> <span class="o">*</span> <span class="n">r</span>
    <span class="n">err</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">InnerProduct</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">w</span><span class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;iteration&quot;</span><span class="p">,</span> <span class="n">its</span><span class="p">,</span> <span class="s2">&quot;res=&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
    <span class="n">gfu</span><span class="o">.</span><span class="n">vec</span><span class="o">.</span><span class="n">data</span> <span class="o">+=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">w</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">&lt;</span> <span class="mf">1e-8</span> <span class="o">*</span> <span class="n">err0</span> <span class="ow">or</span> <span class="n">its</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">:</span> <span class="k">break</span>
    <span class="n">its</span> <span class="o">=</span> <span class="n">its</span><span class="o">+</span><span class="mi">1</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;needed&quot;</span><span class="p">,</span> <span class="n">its</span><span class="p">,</span> <span class="s2">&quot;iterations&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iteration 0 res= 0.01669736401134929
iteration 1 res= 0.01612994796573499
iteration 2 res= 0.015738964207779094
iteration 3 res= 0.01537521337109729
iteration 4 res= 0.015027647518184271
iteration 5 res= 0.014692967602527685
iteration 6 res= 0.014369608334160849
iteration 7 res= 0.01405661620305208
iteration 8 res= 0.013753309526659605
iteration 9 res= 0.013459149108497314
iteration 10 res= 0.013173681011309115
iteration 11 res= 0.012896507904167152
iteration 12 res= 0.012627273109351092
iteration 13 res= 0.012365650902348979
iteration 14 res= 0.012111340188515871
iteration 15 res= 0.011864060154063449
iteration 16 res= 0.011623547148711885
iteration 17 res= 0.011389552376561557
iteration 18 res= 0.011161840138254176
iteration 19 res= 0.010940186460517245
iteration 20 res= 0.010724378004348637
iteration 21 res= 0.01051421117747227
iteration 22 res= 0.01030949139899154
iteration 23 res= 0.010110032479095797
iteration 24 res= 0.009915656086926657
iteration 25 res= 0.009726191286892918
iteration 26 res= 0.009541474128835775
iteration 27 res= 0.009361347281133822
iteration 28 res= 0.009185659698525401
iteration 29 res= 0.00901426631840292
iteration 30 res= 0.008847027780798771
iteration 31 res= 0.008683810168374722
iteration 32 res= 0.00852448476354638
iteration 33 res= 0.008368927820491737
iteration 34 res= 0.008217020350261024
iteration 35 res= 0.008068647917561069
iteration 36 res= 0.00792370044805986
iteration 37 res= 0.007782072045265968
iteration 38 res= 0.0076436608161994145
iteration 39 res= 0.007508368705195619
iteration 40 res= 0.007376101335282367
iteration 41 res= 0.007246767856646629
iteration 42 res= 0.007120280801769136
iteration 43 res= 0.006996555946853499
iteration 44 res= 0.0068755121792158655
iteration 45 res= 0.0067570713703331555
iteration 46 res= 0.006641158254274435
iteration 47 res= 0.006527700311261775
iteration 48 res= 0.0064166276561256185
iteration 49 res= 0.006307872931435398
iteration 50 res= 0.0062013712050999
iteration 51 res= 0.0060970598722437964
iteration 52 res= 0.00599487856117743
iteration 53 res= 0.005894769043286249
iteration 54 res= 0.005796675146675183
iteration 55 res= 0.005700542673410771
iteration 56 res= 0.005606319320211261
iteration 57 res= 0.005513954602441528
iteration 58 res= 0.005423399781275852
iteration 59 res= 0.0053346077938976
iteration 60 res= 0.005247533186610142
iteration 61 res= 0.005162132050738753
iteration 62 res= 0.005078361961208089
iteration 63 res= 0.004996181917684589
iteration 64 res= 0.004915552288177536
iteration 65 res= 0.004836434754997033
iteration 66 res= 0.00475879226297095
iteration 67 res= 0.004682588969827064
iteration 68 res= 0.00460779019865028
iteration 69 res= 0.004534362392328504
iteration 70 res= 0.004462273069904074
iteration 71 res= 0.0043914907847511665
iteration 72 res= 0.004321985084502698
iteration 73 res= 0.004253726472653338
iteration 74 res= 0.00418668637176824
iteration 75 res= 0.004120837088229892
iteration 76 res= 0.004056151778458353
iteration 77 res= 0.003992604416542576
iteration 78 res= 0.0039301697632232796
iteration 79 res= 0.003868823336170089
iteration 80 res= 0.003808541381498158
iteration 81 res= 0.0037493008464715588
iteration 82 res= 0.003691079353343125
iteration 83 res= 0.0036338551742823005
iteration 84 res= 0.0035776072073447013
iteration 85 res= 0.003522314953438948
iteration 86 res= 0.0034679584942482276
iteration 87 res= 0.003414518471065726
iteration 88 res= 0.003361976064504905
iteration 89 res= 0.0033103129750472345
iteration 90 res= 0.003259511404391354
iteration 91 res= 0.003209554037569488
iteration 92 res= 0.0031604240257981017
iteration 93 res= 0.0031121049700313587
iteration 94 res= 0.003064580905187181
iteration 95 res= 0.003017836285017048
iteration 96 res= 0.0029718559675918762
iteration 97 res= 0.0029266252013775513
iteration 98 res= 0.0028821296118747004
iteration 99 res= 0.002838355188798552
iteration 100 res= 0.002795288273775654
iteration 101 res= 0.0027529155485351868
iteration 102 res= 0.0027112240235737223
iteration 103 res= 0.002670201027273036
iteration 104 res= 0.0026298341954515154
iteration 105 res= 0.002590111461330667
iteration 106 res= 0.0025510210458987454
iteration 107 res= 0.0025125514486546595
iteration 108 res= 0.00247469143871574
iteration 109 res= 0.0024374300462738615
iteration 110 res= 0.0024007565543849993
iteration 111 res= 0.0023646604910779715
iteration 112 res= 0.0023291316217687644
iteration 113 res= 0.00229415994196735
iteration 114 res= 0.0022597356702646104
iteration 115 res= 0.002225849241587433
iteration 116 res= 0.002192491300710503
iteration 117 res= 0.0021596526960140257
iteration 118 res= 0.0021273244734768713
iteration 119 res= 0.0020954978708952205
iteration 120 res= 0.00206416431231711
iteration 121 res= 0.0020333154026839642
iteration 122 res= 0.0020029429226701236
iteration 123 res= 0.0019730388237122966
iteration 124 res= 0.0019435952232208442
iteration 125 res= 0.0019146043999652817
iteration 126 res= 0.0018860587896268202
iteration 127 res= 0.0018579509805108324
iteration 128 res= 0.0018302737094127663
iteration 129 res= 0.0018030198576310544
iteration 130 res= 0.0017761824471207975
iteration 131 res= 0.0017497546367827837
iteration 132 res= 0.0017237297188818393
iteration 133 res= 0.0016981011155894996
iteration 134 res= 0.0016728623756458217
iteration 135 res= 0.0016480071711354328
iteration 136 res= 0.0016235292943731902
iteration 137 res= 0.0015994226548950812
iteration 138 res= 0.001575681276549971
iteration 139 res= 0.0015522992946882383
iteration 140 res= 0.0015292709534433869
iteration 141 res= 0.0015065906031028506
iteration 142 res= 0.0014842526975645284
iteration 143 res= 0.001462251791875555
iteration 144 res= 0.0014405825398501216
iteration 145 res= 0.0014192396917631436
iteration 146 res= 0.0013982180921169466
iteration 147 res= 0.0013775126774778661
iteration 148 res= 0.0013571184743803317
iteration 149 res= 0.0013370305972956011
iteration 150 res= 0.001317244246662706
iteration 151 res= 0.0012977547069792483
iteration 152 res= 0.0012785573449497823
iteration 153 res= 0.0012596476076894162
iteration 154 res= 0.0012410210209808168
iteration 155 res= 0.0012226731875823317
iteration 156 res= 0.001204599785585522
iteration 157 res= 0.0011867965668200797
iteration 158 res= 0.00116925935530454
iteration 159 res= 0.0011519840457409403
iteration 160 res= 0.001134966602051976
iteration 161 res= 0.0011182030559588872
iteration 162 res= 0.0011016895055988235
iteration 163 res= 0.0010854221141801098
iteration 164 res= 0.0010693971086741011
iteration 165 res= 0.0010536107785423135
iteration 166 res= 0.0010380594744975736
iteration 167 res= 0.0010227396072980228
iteration 168 res= 0.0010076476465727638
iteration 169 res= 0.000992780119678111
iteration 170 res= 0.0009781336105833254
iteration 171 res= 0.0009637047587848823
iteration 172 res= 0.0009494902582482298
iteration 173 res= 0.0009354868563762032
iteration 174 res= 0.0009216913530030635
iteration 175 res= 0.0009081005994134159
iteration 176 res= 0.0008947114973852071
iteration 177 res= 0.0008815209982557881
iteration 178 res= 0.0008685261020106305
iteration 179 res= 0.0008557238563936243
iteration 180 res= 0.0008431113560385187
iteration 181 res= 0.0008306857416206672
iteration 182 res= 0.0008184441990285109
iteration 183 res= 0.0008063839585541569
iteration 184 res= 0.0007945022941024558
iteration 185 res= 0.0007827965224180025
iteration 186 res= 0.0007712640023295193
iteration 187 res= 0.0007599021340110828
iteration 188 res= 0.000748708358259672
iteration 189 res= 0.0007376801557885836
iteration 190 res= 0.0007268150465362214
iteration 191 res= 0.0007161105889897882
iteration 192 res= 0.0007055643795234659
iteration 193 res= 0.0006951740517506987
iteration 194 res= 0.0006849372758900399
iteration 195 res= 0.0006748517581444132
iteration 196 res= 0.0006649152400931068
iteration 197 res= 0.0006551254980964506
iteration 198 res= 0.0006454803427125517
iteration 199 res= 0.0006359776181259796
iteration 200 res= 0.0006266152015879049
iteration 201 res= 0.0006173910028674902
iteration 202 res= 0.0006083029637141901
iteration 203 res= 0.0005993490573306509
iteration 204 res= 0.000590527287855983
iteration 205 res= 0.0005818356898590829
iteration 206 res= 0.0005732723278417769
iteration 207 res= 0.0005648352957515122
iteration 208 res= 0.000556522716503377
iteration 209 res= 0.0005483327415112265
iteration 210 res= 0.0005402635502275687
iteration 211 res= 0.0005323133496921849
iteration 212 res= 0.000524480374089152
iteration 213 res= 0.0005167628843120434
iteration 214 res= 0.0005091591675371347
iteration 215 res= 0.0005016675368045478
iteration 216 res= 0.0004942863306068866
iteration 217 res= 0.0004870139124854383
iteration 218 res= 0.00047984867063361093
iteration 219 res= 0.00047278901750751875
iteration 220 res= 0.00046583338944349755
iteration 221 res= 0.0004589802462824153
iteration 222 res= 0.0004522280710006645
iteration 223 res= 0.0004455753693475956
iteration 224 res= 0.0004390206694893256
iteration 225 res= 0.00043256252165878485
iteration 226 res= 0.00042619949781177454
iteration 227 res= 0.0004199301912890127
iteration 228 res= 0.0004137532164839992
iteration 229 res= 0.0004076672085165492
iteration 230 res= 0.0004016708229118857
iteration 231 res= 0.0003957627352852584
iteration 232 res= 0.00038994164103177864
iteration 233 res= 0.00038420625502160296
iteration 234 res= 0.0003785553113002003
iteration 235 res= 0.00037298756279357994
iteration 236 res= 0.000367501781018515
iteration 237 res= 0.00036209675579754587
iteration 238 res= 0.00035677129497871824
iteration 239 res= 0.0003515242241599078
iteration 240 res= 0.00034635438641774936
iteration 241 res= 0.00034126064204095113
iteration 242 res= 0.0003362418682680222
iteration 243 res= 0.0003312969590292276
iteration 244 res= 0.0003264248246927587
iteration 245 res= 0.00032162439181507085
iteration 246 res= 0.0003168946028951311
iteration 247 res= 0.0003122344161327803
iteration 248 res= 0.0003076428051908411
iteration 249 res= 0.00030311875896116535
iteration 250 res= 0.000298661281334326
iteration 251 res= 0.00029426939097305113
iteration 252 res= 0.0002899421210892194
iteration 253 res= 0.00028567851922442516
iteration 254 res= 0.0002814776470340232
iteration 255 res= 0.0002773385800745676
iteration 256 res= 0.00027326040759462564
iteration 257 res= 0.00026924223232888583
iteration 258 res= 0.00026528317029549483
iteration 259 res= 0.0002613823505965441
iteration 260 res= 0.00025753891522175166
iteration 261 res= 0.0002537520188551556
iteration 262 res= 0.0002500208286848421
iteration 263 res= 0.0002463445242156025
iteration 264 res= 0.00024272229708458934
iteration 265 res= 0.00023915335087973494
iteration 266 res= 0.00023563690096103462
iteration 267 res= 0.00023217217428461446
iteration 268 res= 0.00022875840922944706
iteration 269 res= 0.00022539485542680642
iteration 270 res= 0.00022208077359234105
iteration 271 res= 0.0002188154353606861
iteration 272 res= 0.00021559812312264034
iteration 273 res= 0.0002124281298649113
iteration 274 res= 0.00020930475901214567
iteration 275 res= 0.00020622732427158172
iteration 276 res= 0.0002031951494799164
iteration 277 res= 0.00020020756845259862
iteration 278 res= 0.00019726392483536702
iteration 279 res= 0.0001943635719580937
iteration 280 res= 0.0001915058726908446
iteration 281 res= 0.00018869019930207353
iteration 282 res= 0.0001859159333190537
iteration 283 res= 0.0001831824653903618
iteration 284 res= 0.0001804891951504891
iteration 285 res= 0.0001778355310864511
iteration 286 res= 0.0001752208904064687
iteration 287 res= 0.00017264469891061502
iteration 288 res= 0.00017010639086341076
iteration 289 res= 0.00016760540886832288
iteration 290 res= 0.00016514120374419594
iteration 291 res= 0.0001627132344035462
iteration 292 res= 0.0001603209677326149
iteration 293 res= 0.0001579638784733304
iteration 294 res= 0.00015564144910696422
iteration 295 res= 0.00015335316973957069
iteration 296 res= 0.00015109853798914928
iteration 297 res= 0.00014887705887447553
iteration 298 res= 0.00014668824470564284
iteration 299 res= 0.00014453161497616455
iteration 300 res= 0.00014240669625679254
iteration 301 res= 0.00014031302209086403
iteration 302 res= 0.00013825013289120225
iteration 303 res= 0.00013621757583862242
iteration 304 res= 0.00013421490478186628
iteration 305 res= 0.0001322416801391279
iteration 306 res= 0.0001302974688009537
iteration 307 res= 0.00012838184403469804
iteration 308 res= 0.00012649438539028503
iteration 309 res= 0.00012463467860745057
iteration 310 res= 0.00012280231552439668
iteration 311 res= 0.00012099689398768669
iteration 312 res= 0.00011921801776362795
iteration 313 res= 0.0001174652964508483
iteration 314 res= 0.00011573834539424638
iteration 315 res= 0.0001140367856002268
iteration 316 res= 0.00011236024365312201
iteration 317 res= 0.00011070835163294513
iteration 318 res= 0.00010908074703431828
iteration 319 res= 0.00010747707268659454
iteration 320 res= 0.00010589697667518981
iteration 321 res= 0.00010434011226411235
iteration 322 res= 0.00010280613781953373
iteration 323 res= 0.00010129471673462876
iteration 324 res= 9.980551735544697e-05
iteration 325 res= 9.833821290789207e-05
iteration 326 res= 9.689248142581004e-05
iteration 327 res= 9.546800568011607e-05
iteration 328 res= 9.406447310898543e-05
iteration 329 res= 9.268157574908905e-05
iteration 330 res= 9.131901016780731e-05
iteration 331 res= 8.997647739650367e-05
iteration 332 res= 8.865368286474697e-05
iteration 333 res= 8.73503363355038e-05
iteration 334 res= 8.606615184131983e-05
iteration 335 res= 8.480084762142333e-05
iteration 336 res= 8.355414605975043e-05
iteration 337 res= 8.232577362391965e-05
iteration 338 res= 8.111546080509787e-05
iteration 339 res= 7.99229420587053e-05
iteration 340 res= 7.874795574607066e-05
iteration 341 res= 7.759024407692449e-05
iteration 342 res= 7.644955305268999e-05
iteration 343 res= 7.532563241071952e-05
iteration 344 res= 7.421823556921973e-05
iteration 345 res= 7.312711957310616e-05
iteration 346 res= 7.205204504063436e-05
iteration 347 res= 7.099277611069362e-05
iteration 348 res= 6.994908039112058e-05
iteration 349 res= 6.892072890753451e-05
iteration 350 res= 6.79074960530703e-05
iteration 351 res= 6.690915953878846e-05
iteration 352 res= 6.592550034489604e-05
iteration 353 res= 6.495630267256337e-05
iteration 354 res= 6.40013538965719e-05
iteration 355 res= 6.30604445185797e-05
iteration 356 res= 6.213336812111899e-05
iteration 357 res= 6.121992132225862e-05
iteration 358 res= 6.0319903730932296e-05
iteration 359 res= 5.943311790292525e-05
iteration 360 res= 5.8559369297520345e-05
iteration 361 res= 5.7698466234776645e-05
iteration 362 res= 5.685021985344615e-05
iteration 363 res= 5.6014444069441215e-05
iteration 364 res= 5.519095553507678e-05
iteration 365 res= 5.437957359873691e-05
iteration 366 res= 5.358012026521366e-05
iteration 367 res= 5.279242015666699e-05
iteration 368 res= 5.201630047409118e-05
iteration 369 res= 5.125159095935977e-05
iteration 370 res= 5.04981238578881e-05
iteration 371 res= 4.975573388177851e-05
iteration 372 res= 4.902425817355982e-05
iteration 373 res= 4.8303536270375764e-05
iteration 374 res= 4.759341006885467e-05
iteration 375 res= 4.6893723790300514e-05
iteration 376 res= 4.6204323946586604e-05
iteration 377 res= 4.5525059306409e-05
iteration 378 res= 4.485578086210383e-05
iteration 379 res= 4.419634179696907e-05
iteration 380 res= 4.354659745298148e-05
iteration 381 res= 4.290640529911995e-05
iteration 382 res= 4.227562490000566e-05
iteration 383 res= 4.165411788513709e-05
iteration 384 res= 4.104174791849809e-05
iteration 385 res= 4.043838066865461e-05
iteration 386 res= 3.984388377922475e-05
iteration 387 res= 3.92581268398946e-05
iteration 388 res= 3.868098135776186e-05
iteration 389 res= 3.811232072913003e-05
iteration 390 res= 3.7552020211767165e-05
iteration 391 res= 3.699995689746682e-05
iteration 392 res= 3.6456009685150784e-05
iteration 393 res= 3.592005925422759e-05
iteration 394 res= 3.539198803844754e-05
iteration 395 res= 3.487168020008552e-05
iteration 396 res= 3.4359021604547504e-05
iteration 397 res= 3.3853899795305955e-05
iteration 398 res= 3.33562039692073e-05
iteration 399 res= 3.286582495219226e-05
iteration 400 res= 3.238265517531871e-05
iteration 401 res= 3.190658865117334e-05
iteration 402 res= 3.143752095059098e-05
iteration 403 res= 3.097534917978756e-05
iteration 404 res= 3.051997195771588e-05
iteration 405 res= 3.0071289393885822e-05
iteration 406 res= 2.962920306641394e-05
iteration 407 res= 2.9193616000428685e-05
iteration 408 res= 2.8764432646795513e-05
iteration 409 res= 2.83415588611758e-05
iteration 410 res= 2.7924901883327174e-05
iteration 411 res= 2.751437031678765e-05
iteration 412 res= 2.7109874108826344e-05
iteration 413 res= 2.671132453062894e-05
iteration 414 res= 2.631863415791603e-05
iteration 415 res= 2.593171685170406e-05
iteration 416 res= 2.5550487739403676e-05
iteration 417 res= 2.5174863196239218e-05
iteration 418 res= 2.480476082687308e-05
iteration 419 res= 2.4440099447348058e-05
iteration 420 res= 2.4080799067228363e-05
iteration 421 res= 2.3726780872116174e-05
iteration 422 res= 2.3377967206324465e-05
iteration 423 res= 2.3034281555844645e-05
iteration 424 res= 2.2695648531561338e-05
iteration 425 res= 2.2361993852711623e-05
iteration 426 res= 2.203324433059058e-05
iteration 427 res= 2.170932785249904e-05
iteration 428 res= 2.1390173365923878e-05
iteration 429 res= 2.1075710862939683e-05
iteration 430 res= 2.076587136485947e-05
iteration 431 res= 2.0460586907094932e-05
iteration 432 res= 2.0159790524249032e-05
iteration 433 res= 1.9863416235454354e-05
iteration 434 res= 1.9571399029827212e-05
iteration 435 res= 1.928367485230131e-05
iteration 436 res= 1.900018058946884e-05
iteration 437 res= 1.872085405584281e-05
iteration 438 res= 1.8445633980123204e-05
iteration 439 res= 1.8174459991814966e-05
iteration 440 res= 1.7907272607968873e-05
iteration 441 res= 1.764401322011496e-05
iteration 442 res= 1.7384624081421464e-05
iteration 443 res= 1.7129048294047494e-05
iteration 444 res= 1.6877229796602687e-05
iteration 445 res= 1.6629113351911648e-05
iteration 446 res= 1.6384644534853275e-05
iteration 447 res= 1.6143769720447236e-05
iteration 448 res= 1.590643607208584e-05
iteration 449 res= 1.567259152992764e-05
iteration 450 res= 1.54421847994958e-05
iteration 451 res= 1.5215165340405484e-05
iteration 452 res= 1.4991483355317227e-05
iteration 453 res= 1.4771089778964605e-05
iteration 454 res= 1.455393626740683e-05
iteration 455 res= 1.433997518745176e-05
iteration 456 res= 1.4129159606169118e-05
iteration 457 res= 1.3921443280604649e-05
iteration 458 res= 1.3716780647662834e-05
iteration 459 res= 1.3515126814076632e-05
iteration 460 res= 1.3316437546573455e-05
iteration 461 res= 1.3120669262177263e-05
iteration 462 res= 1.2927779018638334e-05
iteration 463 res= 1.2737724505036279e-05
iteration 464 res= 1.255046403244524e-05
iteration 465 res= 1.2365956524861382e-05
iteration 466 res= 1.2184161510132251e-05
iteration 467 res= 1.2005039111124734e-05
iteration 468 res= 1.1828550036913883e-05
iteration 469 res= 1.165465557426158e-05
iteration 470 res= 1.148331757901546e-05
iteration 471 res= 1.131449846782983e-05
iteration 472 res= 1.1148161209867762e-05
iteration 473 res= 1.0984269318704049e-05
iteration 474 res= 1.0822786844318626e-05
iteration 475 res= 1.0663678365182028e-05
iteration 476 res= 1.0506908980539168e-05
iteration 477 res= 1.0352444302708584e-05
iteration 478 res= 1.0200250449546485e-05
iteration 479 res= 1.0050294037031989e-05
iteration 480 res= 9.902542171935808e-06
iteration 481 res= 9.756962444610878e-06
iteration 482 res= 9.613522921852318e-06
iteration 483 res= 9.472192139929835e-06
iteration 484 res= 9.332939097666128e-06
iteration 485 res= 9.195733249661016e-06
iteration 486 res= 9.060544499542081e-06
iteration 487 res= 8.927343193417483e-06
iteration 488 res= 8.796100113334491e-06
iteration 489 res= 8.666786470889176e-06
iteration 490 res= 8.539373900904503e-06
iteration 491 res= 8.413834455206192e-06
iteration 492 res= 8.29014059648463e-06
iteration 493 res= 8.168265192297138e-06
iteration 494 res= 8.048181509039557e-06
iteration 495 res= 7.929863206162814e-06
iteration 496 res= 7.813284330336476e-06
iteration 497 res= 7.698419309784283e-06
iteration 498 res= 7.585242948684712e-06
iteration 499 res= 7.473730421597934e-06
iteration 500 res= 7.363857268066379e-06
iteration 501 res= 7.255599387243277e-06
iteration 502 res= 7.148933032569082e-06
iteration 503 res= 7.0438348066141e-06
iteration 504 res= 6.940281655900808e-06
iteration 505 res= 6.838250865889488e-06
iteration 506 res= 6.737720055949445e-06
iteration 507 res= 6.638667174496144e-06
iteration 508 res= 6.541070494119951e-06
iteration 509 res= 6.444908606825327e-06
iteration 510 res= 6.3501604193634604e-06
iteration 511 res= 6.2568051485688e-06
iteration 512 res= 6.164822316800964e-06
iteration 513 res= 6.074191747497779e-06
iteration 514 res= 5.984893560690498e-06
iteration 515 res= 5.896908168698832e-06
iteration 516 res= 5.810216271785619e-06
iteration 517 res= 5.724798853948388e-06
iteration 518 res= 5.640637178743457e-06
iteration 519 res= 5.557712785178533e-06
iteration 520 res= 5.476007483670909e-06
iteration 521 res= 5.3955033520304234e-06
iteration 522 res= 5.316182731557042e-06
iteration 523 res= 5.238028223152585e-06
iteration 524 res= 5.161022683518807e-06
iteration 525 res= 5.0851492213610516e-06
iteration 526 res= 5.010391193730266e-06
iteration 527 res= 4.936732202344969e-06
iteration 528 res= 4.864156089987165e-06
iteration 529 res= 4.792646936989539e-06
iteration 530 res= 4.722189057707449e-06
iteration 531 res= 4.652766997106468e-06
iteration 532 res= 4.584365527346186e-06
iteration 533 res= 4.516969644480919e-06
iteration 534 res= 4.450564565110675e-06
iteration 535 res= 4.38513572319761e-06
iteration 536 res= 4.320668766817672e-06
iteration 537 res= 4.257149555064315e-06
iteration 538 res= 4.194564154897808e-06
iteration 539 res= 4.132898838119687e-06
iteration 540 res= 4.072140078361333e-06
iteration 541 res= 4.012274548097704e-06
iteration 542 res= 3.953289115740002e-06
iteration 543 res= 3.8951708427453774e-06
iteration 544 res= 3.837906980801075e-06
iteration 545 res= 3.7814849689782255e-06
iteration 546 res= 3.725892431040651e-06
iteration 547 res= 3.6711171726804956e-06
iteration 548 res= 3.617147178876229e-06
iteration 549 res= 3.56397061123135e-06
iteration 550 res= 3.511575805386891e-06
iteration 551 res= 3.4599512684647693e-06
iteration 552 res= 3.4090856765543494e-06
iteration 553 res= 3.3589678722275536e-06
iteration 554 res= 3.3095868620527647e-06
iteration 555 res= 3.260931814253091e-06
iteration 556 res= 3.2129920562748393e-06
iteration 557 res= 3.1657570724521216e-06
iteration 558 res= 3.1192165017301095e-06
iteration 559 res= 3.0733601353782633e-06
iteration 560 res= 3.028177914746936e-06
iteration 561 res= 2.9836599290272263e-06
iteration 562 res= 2.9397964131477118e-06
iteration 563 res= 2.896577745592491e-06
iteration 564 res= 2.853994446284911e-06
iteration 565 res= 2.8120371745122655e-06
iteration 566 res= 2.7706967268982384e-06
iteration 567 res= 2.729964035353533e-06
iteration 568 res= 2.6898301651062375e-06
iteration 569 res= 2.650286312738781e-06
iteration 570 res= 2.611323804251858e-06
iteration 571 res= 2.5729340931611335e-06
iteration 572 res= 2.535108758637385e-06
iteration 573 res= 2.497839503643233e-06
iteration 574 res= 2.461118153108918e-06
iteration 575 res= 2.4249366521542623e-06
iteration 576 res= 2.389287064323794e-06
iteration 577 res= 2.354161569830456e-06
iteration 578 res= 2.3195524638518236e-06
iteration 579 res= 2.2854521548269814e-06
iteration 580 res= 2.251853162812809e-06
iteration 581 res= 2.218748117825076e-06
iteration 582 res= 2.1861297582154397e-06
iteration 583 res= 2.153990929112174e-06
iteration 584 res= 2.122324580818796e-06
iteration 585 res= 2.091123767273936e-06
iteration 586 res= 2.06038164454184e-06
iteration 587 res= 2.0300914692950213e-06
iteration 588 res= 2.0002465973409556e-06
iteration 589 res= 1.970840482166678e-06
iteration 590 res= 1.94186667350042e-06
iteration 591 res= 1.913318815901602e-06
iteration 592 res= 1.885190647352228e-06
iteration 593 res= 1.8574759979013981e-06
iteration 594 res= 1.8301687883128983e-06
iteration 595 res= 1.8032630287029625e-06
iteration 596 res= 1.7767528172605909e-06
iteration 597 res= 1.7506323389354983e-06
iteration 598 res= 1.7248958641619267e-06
iteration 599 res= 1.6995377476125963e-06
iteration 600 res= 1.6745524269514482e-06
iteration 601 res= 1.6499344216138504e-06
iteration 602 res= 1.6256783315957064e-06
iteration 603 res= 1.6017788363062758e-06
iteration 604 res= 1.5782306933581696e-06
iteration 605 res= 1.5550287374256208e-06
iteration 606 res= 1.5321678791357366e-06
iteration 607 res= 1.5096431039297818e-06
iteration 608 res= 1.4874494709537276e-06
iteration 609 res= 1.4655821120191136e-06
iteration 610 res= 1.444036230484284e-06
iteration 611 res= 1.4228071002335307e-06
iteration 612 res= 1.401890064626012e-06
iteration 613 res= 1.381280535482064e-06
iteration 614 res= 1.3609739920813544e-06
iteration 615 res= 1.3409659801483875e-06
iteration 616 res= 1.3212521108991006e-06
iteration 617 res= 1.3018280600642465e-06
iteration 618 res= 1.2826895669718524e-06
iteration 619 res= 1.2638324335531728e-06
iteration 620 res= 1.2452525234623955e-06
iteration 621 res= 1.2269457611876821e-06
iteration 622 res= 1.208908131111934e-06
iteration 623 res= 1.191135676650574e-06
iteration 624 res= 1.173624499400046e-06
iteration 625 res= 1.1563707582440311e-06
iteration 626 res= 1.1393706685723223e-06
iteration 627 res= 1.1226205013852744e-06
iteration 628 res= 1.1061165825015986e-06
iteration 629 res= 1.0898552917714861e-06
iteration 630 res= 1.0738330622639616e-06
iteration 631 res= 1.0580463794830496e-06
iteration 632 res= 1.0424917805788246e-06
iteration 633 res= 1.027165853653811e-06
iteration 634 res= 1.0120652369234719e-06
iteration 635 res= 9.971866180643376e-07
iteration 636 res= 9.825267334290764e-07
iteration 637 res= 9.680823673391924e-07
iteration 638 res= 9.53850351415283e-07
iteration 639 res= 9.398275638455887e-07
iteration 640 res= 9.260109287107827e-07
iteration 641 res= 9.123974153079271e-07
iteration 642 res= 8.989840375036301e-07
iteration 643 res= 8.857678530533994e-07
iteration 644 res= 8.727459629632932e-07
iteration 645 res= 8.599155108771306e-07
iteration 646 res= 8.472736823896349e-07
iteration 647 res= 8.348177045326502e-07
iteration 648 res= 8.225448450588277e-07
iteration 649 res= 8.104524118926901e-07
iteration 650 res= 7.985377525548884e-07
iteration 651 res= 7.867982535320876e-07
iteration 652 res= 7.752313397574582e-07
iteration 653 res= 7.63834474023905e-07
iteration 654 res= 7.526051564069826e-07
iteration 655 res= 7.415409237216314e-07
iteration 656 res= 7.306393490393267e-07
iteration 657 res= 7.198980410780523e-07
iteration 658 res= 7.093146437177396e-07
iteration 659 res= 6.988868354718188e-07
iteration 660 res= 6.886123289791549e-07
iteration 661 res= 6.784888705348572e-07
iteration 662 res= 6.685142395306598e-07
iteration 663 res= 6.586862480111074e-07
iteration 664 res= 6.490027402085052e-07
iteration 665 res= 6.394615920176171e-07
iteration 666 res= 6.300607105887836e-07
iteration 667 res= 6.207980338154924e-07
iteration 668 res= 6.116715299280895e-07
iteration 669 res= 6.026791970079067e-07
iteration 670 res= 5.938190625649574e-07
iteration 671 res= 5.850891831399561e-07
iteration 672 res= 5.764876438122669e-07
iteration 673 res= 5.680125578098151e-07
iteration 674 res= 5.596620661245745e-07
iteration 675 res= 5.514343370676563e-07
iteration 676 res= 5.433275658663551e-07
iteration 677 res= 5.353399742961246e-07
iteration 678 res= 5.274698102593756e-07
iteration 679 res= 5.197153474389303e-07
iteration 680 res= 5.120748848690036e-07
iteration 681 res= 5.045467466156271e-07
iteration 682 res= 4.971292813581201e-07
iteration 683 res= 4.898208620809016e-07
iteration 684 res= 4.826198856617805e-07
iteration 685 res= 4.7552477255537786e-07
iteration 686 res= 4.685339664567437e-07
iteration 687 res= 4.616459338973836e-07
iteration 688 res= 4.54859163997912e-07
iteration 689 res= 4.4817216806256953e-07
iteration 690 res= 4.4158347928924633e-07
iteration 691 res= 4.350916524493204e-07
iteration 692 res= 4.286952635368548e-07
iteration 693 res= 4.2239290951300913e-07
iteration 694 res= 4.161832079276821e-07
iteration 695 res= 4.10064796700253e-07
iteration 696 res= 4.0403633372338313e-07
iteration 697 res= 3.9809649665888585e-07
iteration 698 res= 3.922439825973895e-07
iteration 699 res= 3.864775077742319e-07
iteration 700 res= 3.8079580730916396e-07
iteration 701 res= 3.751976349109855e-07
iteration 702 res= 3.696817626217255e-07
iteration 703 res= 3.6424698052222075e-07
iteration 704 res= 3.588920964823644e-07
iteration 705 res= 3.536159359001832e-07
iteration 706 res= 3.4841734144664347e-07
iteration 707 res= 3.432951728139713e-07
iteration 708 res= 3.3824830642952733e-07
iteration 709 res= 3.332756352574566e-07
iteration 710 res= 3.2837606854903364e-07
iteration 711 res= 3.2354853156733576e-07
iteration 712 res= 3.1879196538799995e-07
iteration 713 res= 3.141053266562446e-07
iteration 714 res= 3.0948758734429765e-07
iteration 715 res= 3.0493773455280394e-07
iteration 716 res= 3.004547702623979e-07
iteration 717 res= 2.9603771112107733e-07
iteration 718 res= 2.9168558825040006e-07
iteration 719 res= 2.8739744700211324e-07
iteration 720 res= 2.8317234676938576e-07
iteration 721 res= 2.7900936077875136e-07
iteration 722 res= 2.7490757584575515e-07
iteration 723 res= 2.708660922741752e-07
iteration 724 res= 2.6688402353382716e-07
iteration 725 res= 2.6296049616342084e-07
iteration 726 res= 2.5909464952787856e-07
iteration 727 res= 2.5528563565358174e-07
iteration 728 res= 2.5153261901716364e-07
iteration 729 res= 2.4783477640176666e-07
iteration 730 res= 2.4419129667654666e-07
iteration 731 res= 2.406013806365802e-07
iteration 732 res= 2.3706424083839624e-07
iteration 733 res= 2.3357910139185888e-07
iteration 734 res= 2.3014519783315818e-07
iteration 735 res= 2.267617769326703e-07
iteration 736 res= 2.2342809653840793e-07
iteration 737 res= 2.2014342538119778e-07
iteration 738 res= 2.16907042992029e-07
iteration 739 res= 2.137182394470848e-07
iteration 740 res= 2.1057631528445735e-07
iteration 741 res= 2.0748058131939592e-07
iteration 742 res= 2.0443035849105694e-07
iteration 743 res= 2.014249777425841e-07
iteration 744 res= 1.9846377982808214e-07
iteration 745 res= 1.9554611521073443e-07
iteration 746 res= 1.926713438988972e-07
iteration 747 res= 1.898388353042372e-07
iteration 748 res= 1.8704796810283934e-07
iteration 749 res= 1.8429813012879083e-07
iteration 750 res= 1.8158871819646589e-07
iteration 751 res= 1.7891913799587218e-07
iteration 752 res= 1.7628880394362832e-07
iteration 753 res= 1.7369713907461402e-07
iteration 754 res= 1.7114357490431784e-07
iteration 755 res= 1.6862755131082097e-07
iteration 756 res= 1.6614851639315612e-07
iteration 757 res= 1.637059263757356e-07
iteration 758 res= 1.6129924547184466e-07
iteration 759 res= 1.589279457706191e-07
iteration 760 res= 1.565915071319742e-07
iteration 761 res= 1.5428941704529725e-07
iteration 762 res= 1.5202117055123254e-07
iteration 763 res= 1.497862701073467e-07
iteration 764 res= 1.475842254760766e-07
iteration 765 res= 1.454145536440914e-07
iteration 766 res= 1.4327677869007508e-07
iteration 767 res= 1.4117043168717249e-07
iteration 768 res= 1.3909505061209622e-07
iteration 769 res= 1.3705018021480008e-07
iteration 770 res= 1.3503537196599982e-07
iteration 771 res= 1.3305018390063287e-07
iteration 772 res= 1.3109418056942736e-07
iteration 773 res= 1.2916693292365377e-07
iteration 774 res= 1.2726801821990406e-07
iteration 775 res= 1.2539701992303937e-07
iteration 776 res= 1.2355352763291734e-07
iteration 777 res= 1.2173713697604098e-07
iteration 778 res= 1.1994744952123016e-07
iteration 779 res= 1.1818407269562515e-07
iteration 780 res= 1.1644661970988723e-07
iteration 781 res= 1.1473470944577003e-07
iteration 782 res= 1.1304796638973326e-07
iteration 783 res= 1.1138602055829872e-07
iteration 784 res= 1.0974850740092672e-07
iteration 785 res= 1.0813506772476451e-07
iteration 786 res= 1.0654534762596699e-07
iteration 787 res= 1.0497899837780736e-07
iteration 788 res= 1.0343567642119898e-07
iteration 789 res= 1.0191504322084478e-07
iteration 790 res= 1.0041676521592359e-07
iteration 791 res= 9.894051376487765e-08
iteration 792 res= 9.748596504980424e-08
iteration 793 res= 9.605280000527843e-08
iteration 794 res= 9.464070427873769e-08
iteration 795 res= 9.324936811951196e-08
iteration 796 res= 9.187848632369494e-08
iteration 797 res= 9.05277582048833e-08
iteration 798 res= 8.919688746538333e-08
iteration 799 res= 8.788558218771144e-08
iteration 800 res= 8.659355472590054e-08
iteration 801 res= 8.53205216758438e-08
iteration 802 res= 8.406620379770727e-08
iteration 803 res= 8.28303259595816e-08
iteration 804 res= 8.161261705273039e-08
iteration 805 res= 8.041280998802681e-08
iteration 806 res= 7.9230641583263e-08
iteration 807 res= 7.806585252740868e-08
iteration 808 res= 7.691818731005472e-08
iteration 809 res= 7.578739420528003e-08
iteration 810 res= 7.46732251650969e-08
iteration 811 res= 7.357543580542562e-08
iteration 812 res= 7.249378530981768e-08
iteration 813 res= 7.142803642189437e-08
iteration 814 res= 7.037795537606727e-08
iteration 815 res= 6.934331182220263e-08
iteration 816 res= 6.832387881450355e-08
iteration 817 res= 6.731943275022267e-08
iteration 818 res= 6.632975328419295e-08
iteration 819 res= 6.535462334078112e-08
iteration 820 res= 6.439382901952205e-08
iteration 821 res= 6.344715957840845e-08
iteration 822 res= 6.251440734852937e-08
iteration 823 res= 6.15953677406007e-08
iteration 824 res= 6.068983916152264e-08
iteration 825 res= 5.979762297414969e-08
iteration 826 res= 5.8918523479242966e-08
iteration 827 res= 5.805234784130448e-08
iteration 828 res= 5.719890606583846e-08
iteration 829 res= 5.635801094487472e-08
iteration 830 res= 5.5529478024192215e-08
iteration 831 res= 5.471312557708947e-08
iteration 832 res= 5.390877451707902e-08
iteration 833 res= 5.311624842065826e-08
iteration 834 res= 5.233537345324977e-08
iteration 835 res= 5.156597831254372e-08
iteration 836 res= 5.080789424145128e-08
iteration 837 res= 5.00609549504874e-08
iteration 838 res= 4.9324996595631986e-08
iteration 839 res= 4.859985774017674e-08
iteration 840 res= 4.788537933688202e-08
iteration 841 res= 4.718140465157686e-08
iteration 842 res= 4.648777927011679e-08
iteration 843 res= 4.580435104828931e-08
iteration 844 res= 4.513097006822962e-08
iteration 845 res= 4.44674886309228e-08
iteration 846 res= 4.3813761185823e-08
iteration 847 res= 4.3169644359660626e-08
iteration 848 res= 4.25349968536658e-08
iteration 849 res= 4.1909679445510005e-08
iteration 850 res= 4.129355498690764e-08
iteration 851 res= 4.068648833050381e-08
iteration 852 res= 4.008834629786996e-08
iteration 853 res= 3.9498997705897774e-08
iteration 854 res= 3.891831326929375e-08
iteration 855 res= 3.834616562052905e-08
iteration 856 res= 3.778242924818028e-08
iteration 857 res= 3.72269805129965e-08
iteration 858 res= 3.6679697551953245e-08
iteration 859 res= 3.6140460338970614e-08
iteration 860 res= 3.5609150580756235e-08
iteration 861 res= 3.5085651745308564e-08
iteration 862 res= 3.4569848986114026e-08
iteration 863 res= 3.406162917683218e-08
iteration 864 res= 3.3560880824180144e-08
iteration 865 res= 3.3067494103690656e-08
iteration 866 res= 3.258136076987205e-08
iteration 867 res= 3.2102374208041614e-08
iteration 868 res= 3.1630429347680536e-08
iteration 869 res= 3.116542265432965e-08
iteration 870 res= 3.070725215319378e-08
iteration 871 res= 3.025581731841407e-08
iteration 872 res= 2.9811019138415266e-08
iteration 873 res= 2.9372760048706853e-08
iteration 874 res= 2.894094391243106e-08
iteration 875 res= 2.851547601387152e-08
iteration 876 res= 2.8096263019438718e-08
iteration 877 res= 2.768321297841559e-08
iteration 878 res= 2.7276235287696872e-08
iteration 879 res= 2.687524067301981e-08
iteration 880 res= 2.6480141179327415e-08
iteration 881 res= 2.6090850135391183e-08
iteration 882 res= 2.5707282167721008e-08
iteration 883 res= 2.5329353117680092e-08
iteration 884 res= 2.4956980095996636e-08
iteration 885 res= 2.4590081418234217e-08
iteration 886 res= 2.4228576614607105e-08
iteration 887 res= 2.387238637842073e-08
iteration 888 res= 2.352143257428206e-08
iteration 889 res= 2.3175638243513888e-08
iteration 890 res= 2.2834927507079558e-08
iteration 891 res= 2.249922564595204e-08
iteration 892 res= 2.2168459024265348e-08
iteration 893 res= 2.1842555075563124e-08
iteration 894 res= 2.152144233281743e-08
iteration 895 res= 2.120505033772559e-08
iteration 896 res= 2.089330970326446e-08
iteration 897 res= 2.058615203709953e-08
iteration 898 res= 2.0283509977328264e-08
iteration 899 res= 1.998531713156991e-08
iteration 900 res= 1.9691508089958294e-08
iteration 901 res= 1.940201840592582e-08
iteration 902 res= 1.9116784588677597e-08
iteration 903 res= 1.8835744057095932e-08
iteration 904 res= 1.8558835170809757e-08
iteration 905 res= 1.828599719560157e-08
iteration 906 res= 1.8017170265919237e-08
iteration 907 res= 1.7752295444475074e-08
iteration 908 res= 1.7491314600867198e-08
iteration 909 res= 1.723417049856527e-08
iteration 910 res= 1.6980806740210482e-08
iteration 911 res= 1.6731167744248344e-08
iteration 912 res= 1.6485198745146694e-08
iteration 913 res= 1.6242845808760255e-08
iteration 914 res= 1.600405575458466e-08
iteration 915 res= 1.5768776216047968e-08
iteration 916 res= 1.5536955573895994e-08
iteration 917 res= 1.5308542979010168e-08
iteration 918 res= 1.508348834641302e-08
iteration 919 res= 1.4861742289863974e-08
iteration 920 res= 1.4643256176821975e-08
iteration 921 res= 1.4427982085857335e-08
iteration 922 res= 1.421587279028314e-08
iteration 923 res= 1.4006881759620179e-08
iteration 924 res= 1.380096316151011e-08
iteration 925 res= 1.3598071822359562e-08
iteration 926 res= 1.3398163248494859e-08
iteration 927 res= 1.3201193565251286e-08
iteration 928 res= 1.300711958950137e-08
iteration 929 res= 1.281589873408822e-08
iteration 930 res= 1.2627489067407314e-08
iteration 931 res= 1.2441849263010728e-08
iteration 932 res= 1.2258938595010908e-08
iteration 933 res= 1.2078716936304756e-08
iteration 934 res= 1.1901144759937752e-08
iteration 935 res= 1.1726183111140224e-08
iteration 936 res= 1.1553793618985358e-08
iteration 937 res= 1.1383938480549483e-08
iteration 938 res= 1.1216580410085809e-08
iteration 939 res= 1.1051682719158234e-08
iteration 940 res= 1.0889209215729044e-08
iteration 941 res= 1.0729124293686752e-08
iteration 942 res= 1.0571392812128157e-08
iteration 943 res= 1.0415980177785452e-08
iteration 944 res= 1.026285230011365e-08
iteration 945 res= 1.011197560042785e-08
iteration 946 res= 9.963316964283193e-09
iteration 947 res= 9.816843802917563e-09
iteration 948 res= 9.672523981784143e-09
iteration 949 res= 9.530325839177417e-09
iteration 950 res= 9.39021818226091e-09
iteration 951 res= 9.252170292570744e-09
iteration 952 res= 9.116151868355035e-09
iteration 953 res= 8.982133088639412e-09
iteration 954 res= 8.850084546886248e-09
iteration 955 res= 8.719977290634156e-09
iteration 956 res= 8.591782765531101e-09
iteration 957 res= 8.465472869256326e-09
iteration 958 res= 8.341019877304802e-09
iteration 959 res= 8.218396505865295e-09
iteration 960 res= 8.0975758391042e-09
iteration 961 res= 7.978531396579186e-09
iteration 962 res= 7.861237050395772e-09
iteration 963 res= 7.745667088950976e-09
iteration 964 res= 7.631796136465488e-09
iteration 965 res= 7.519599231154891e-09
iteration 966 res= 7.4090517613057014e-09
iteration 967 res= 7.3001294815301305e-09
iteration 968 res= 7.19280848685167e-09
iteration 969 res= 7.087065248211635e-09
iteration 970 res= 6.982876565090305e-09
iteration 971 res= 6.880219588893443e-09
iteration 972 res= 6.779071794314848e-09
iteration 973 res= 6.679411005472378e-09
iteration 974 res= 6.581215348415007e-09
iteration 975 res= 6.484463285524999e-09
iteration 976 res= 6.3891336095509216e-09
iteration 977 res= 6.29520538843188e-09
iteration 978 res= 6.20265803331588e-09
iteration 979 res= 6.111471237855994e-09
iteration 980 res= 6.021625005261996e-09
iteration 981 res= 5.9330996229464604e-09
iteration 982 res= 5.845875667748598e-09
iteration 983 res= 5.759934021395526e-09
iteration 984 res= 5.6752558154703735e-09
iteration 985 res= 5.5918224914726226e-09
iteration 986 res= 5.509615743218544e-09
iteration 987 res= 5.42861753017608e-09
iteration 988 res= 5.3488101019072646e-09
iteration 989 res= 5.2701759286628795e-09
iteration 990 res= 5.192697787741829e-09
iteration 991 res= 5.1163586621054395e-09
iteration 992 res= 5.041141820261576e-09
iteration 993 res= 4.967030757193388e-09
iteration 994 res= 4.894009227949833e-09
iteration 995 res= 4.822061195891215e-09
iteration 996 res= 4.751170891746353e-09
iteration 997 res= 4.68132277544115e-09
iteration 998 res= 4.612501497333886e-09
iteration 999 res= 4.54469198531409e-09
iteration 1000 res= 4.47787935417307e-09
iteration 1001 res= 4.412048956245232e-09
iteration 1002 res= 4.347186341540488e-09
iteration 1003 res= 4.283277293364475e-09
iteration 1004 res= 4.2203077839839036e-09
iteration 1005 res= 4.158264007292189e-09
iteration 1006 res= 4.097132342658872e-09
iteration 1007 res= 4.036899403335074e-09
iteration 1008 res= 3.977551950680665e-09
iteration 1009 res= 3.919076989271247e-09
iteration 1010 res= 3.861461678583978e-09
iteration 1011 res= 3.804693385881122e-09
iteration 1012 res= 3.748759654701962e-09
iteration 1013 res= 3.6936482252192693e-09
iteration 1014 res= 3.6393469970929272e-09
iteration 1015 res= 3.5858440634729674e-09
iteration 1016 res= 3.533127696342875e-09
iteration 1017 res= 3.481186312633135e-09
iteration 1018 res= 3.430008546120476e-09
iteration 1019 res= 3.3795831494830727e-09
iteration 1020 res= 3.3298990683039402e-09
iteration 1021 res= 3.2809454115711038e-09
iteration 1022 res= 3.232711433510128e-09
iteration 1023 res= 3.1851865519354e-09
iteration 1024 res= 3.1383603376699254e-09
iteration 1025 res= 3.092222536355026e-09
iteration 1026 res= 3.046763012140984e-09
iteration 1027 res= 3.0019718054834707e-09
iteration 1028 res= 2.9578390825691442e-09
iteration 1029 res= 2.91435516625877e-09
iteration 1030 res= 2.8715105166617724e-09
iteration 1031 res= 2.829295737073959e-09
iteration 1032 res= 2.787701565649372e-09
iteration 1033 res= 2.7467188845591898e-09
iteration 1034 res= 2.706338699932402e-09
iteration 1035 res= 2.666552152072627e-09
iteration 1036 res= 2.6273505154798607e-09
iteration 1037 res= 2.588725188296659e-09
iteration 1038 res= 2.5506677071318875e-09
iteration 1039 res= 2.513169721801223e-09
iteration 1040 res= 2.4762229957686408e-09
iteration 1041 res= 2.4398194340347315e-09
iteration 1042 res= 2.403951051603997e-09
iteration 1043 res= 2.3686099793118503e-09
iteration 1044 res= 2.333788465478349e-09
iteration 1045 res= 2.2994788694345473e-09
iteration 1046 res= 2.2656736636199594e-09
iteration 1047 res= 2.2323654383020056e-09
iteration 1048 res= 2.1995468923342006e-09
iteration 1049 res= 2.1672108133852016e-09
iteration 1050 res= 2.1353501185507814e-09
iteration 1051 res= 2.1039578181203512e-09
iteration 1052 res= 2.0730270147155597e-09
iteration 1053 res= 2.0425509356516664e-09
iteration 1054 res= 2.012522891806172e-09
iteration 1055 res= 1.9829363064001063e-09
iteration 1056 res= 1.95378466883007e-09
iteration 1057 res= 1.925061608158116e-09
iteration 1058 res= 1.8967608063695288e-09
iteration 1059 res= 1.8688760572157457e-09
iteration 1060 res= 1.8414012548792992e-09
iteration 1061 res= 1.814330360396131e-09
iteration 1062 res= 1.787657448136964e-09
iteration 1063 res= 1.7613766592891234e-09
iteration 1064 res= 1.7354822325824646e-09
iteration 1065 res= 1.7099684819026115e-09
iteration 1066 res= 1.684829814809183e-09
iteration 1067 res= 1.6600607178856507e-09
iteration 1068 res= 1.6356557598019234e-09
iteration 1069 res= 1.6116095848039781e-09
iteration 1070 res= 1.5879169206548303e-09
iteration 1071 res= 1.5645725586166123e-09
iteration 1072 res= 1.5415713978248187e-09
iteration 1073 res= 1.5189083800182748e-09
iteration 1074 res= 1.496578530953733e-09
iteration 1075 res= 1.4745769723666527e-09
iteration 1076 res= 1.4528988533013937e-09
iteration 1077 res= 1.4315394267528303e-09
iteration 1078 res= 1.4104940173886773e-09
iteration 1079 res= 1.389757998691544e-09
iteration 1080 res= 1.3693268222497668e-09
iteration 1081 res= 1.3491960134608811e-09
iteration 1082 res= 1.329361158891944e-09
iteration 1083 res= 1.309817894708662e-09
iteration 1084 res= 1.2905619377740759e-09
iteration 1085 res= 1.2715890703209005e-09
iteration 1086 res= 1.2528951325697945e-09
iteration 1087 res= 1.2344760093919336e-09
iteration 1088 res= 1.2163276787040124e-09
iteration 1089 res= 1.1984461481880505e-09
iteration 1090 res= 1.180827494523932e-09
iteration 1091 res= 1.1634678666435541e-09
iteration 1092 res= 1.146363435769884e-09
iteration 1093 res= 1.1295104627313346e-09
iteration 1094 res= 1.1129052581574422e-09
iteration 1095 res= 1.0965441578755013e-09
iteration 1096 res= 1.0804236000408724e-09
iteration 1097 res= 1.0645400300112404e-09
iteration 1098 res= 1.0488899630882543e-09
iteration 1099 res= 1.0334699786960224e-09
iteration 1100 res= 1.0182766865169197e-09
iteration 1101 res= 1.0033067480494263e-09
iteration 1102 res= 9.885568918142705e-10
iteration 1103 res= 9.740238718032219e-10
iteration 1104 res= 9.597045062560882e-10
iteration 1105 res= 9.455956616809044e-10
iteration 1106 res= 9.316942325182578e-10
iteration 1107 res= 9.179971586357545e-10
iteration 1108 res= 9.04501458935606e-10
iteration 1109 res= 8.912041624889075e-10
iteration 1110 res= 8.781023493742538e-10
iteration 1111 res= 8.651931528533802e-10
iteration 1112 res= 8.52473736316889e-10
iteration 1113 res= 8.399413107181307e-10
iteration 1114 res= 8.27593125264544e-10
iteration 1115 res= 8.154264776475022e-10
iteration 1116 res= 8.0343869310691e-10
iteration 1117 res= 7.916271460194193e-10
iteration 1118 res= 7.799892397620044e-10
iteration 1119 res= 7.68522434395239e-10
iteration 1120 res= 7.572241880886985e-10
iteration 1121 res= 7.460920561260062e-10
iteration 1122 res= 7.351235772226929e-10
iteration 1123 res= 7.243163405714888e-10
iteration 1124 res= 7.136679884866427e-10
iteration 1125 res= 7.031761785712448e-10
iteration 1126 res= 6.928386184411391e-10
iteration 1127 res= 6.826530252269231e-10
iteration 1128 res= 6.726171759404796e-10
iteration 1129 res= 6.627288682006093e-10
iteration 1130 res= 6.52985920556248e-10
iteration 1131 res= 6.433862234258602e-10
iteration 1132 res= 6.33927644158094e-10
iteration 1133 res= 6.246081183555348e-10
iteration 1134 res= 6.154255993902838e-10
iteration 1135 res= 6.063780796337604e-10
iteration 1136 res= 5.974635697750971e-10
iteration 1137 res= 5.886801098610932e-10
iteration 1138 res= 5.800257775208965e-10
iteration 1139 res= 5.714986760417469e-10
iteration 1140 res= 5.630969398190802e-10
iteration 1141 res= 5.548187036050649e-10
iteration 1142 res= 5.466621802642495e-10
iteration 1143 res= 5.386255666206373e-10
iteration 1144 res= 5.307071007603909e-10
iteration 1145 res= 5.229050459113472e-10
iteration 1146 res= 5.152176944136936e-10
iteration 1147 res= 5.076433527642088e-10
iteration 1148 res= 5.001803569371732e-10
iteration 1149 res= 4.928270867946716e-10
iteration 1150 res= 4.855819107278954e-10
iteration 1151 res= 4.784432557785998e-10
iteration 1152 res= 4.714095436203874e-10
iteration 1153 res= 4.6447924227377047e-10
iteration 1154 res= 4.5765080950945595e-10
iteration 1155 res= 4.5092278099192315e-10
iteration 1156 res= 4.442936470323786e-10
iteration 1157 res= 4.377619782276076e-10
iteration 1158 res= 4.313263388969897e-10
iteration 1159 res= 4.249852974090886e-10
iteration 1160 res= 4.187374911353145e-10
iteration 1161 res= 4.1258152528283684e-10
iteration 1162 res= 4.0651606226178413e-10
iteration 1163 res= 4.0053977034975947e-10
iteration 1164 res= 3.9465134254866987e-10
iteration 1165 res= 3.8884947336647514e-10
iteration 1166 res= 3.831329019566995e-10
iteration 1167 res= 3.775003704192987e-10
iteration 1168 res= 3.719506466122254e-10
iteration 1169 res= 3.664825034160319e-10
iteration 1170 res= 3.610947588875822e-10
iteration 1171 res= 3.5578621587468106e-10
iteration 1172 res= 3.505557164640324e-10
iteration 1173 res= 3.454021149256028e-10
iteration 1174 res= 3.4032427220462593e-10
iteration 1175 res= 3.353210816298725e-10
iteration 1176 res= 3.3039143616973556e-10
iteration 1177 res= 3.2553428253716e-10
iteration 1178 res= 3.2074852013740615e-10
iteration 1179 res= 3.160331179543122e-10
iteration 1180 res= 3.11387037345953e-10
iteration 1181 res= 3.068092622669169e-10
iteration 1182 res= 3.0229877713857575e-10
iteration 1183 res= 2.97854612961285e-10
iteration 1184 res= 2.934757770068923e-10
iteration 1185 res= 2.8916131765997987e-10
iteration 1186 res= 2.849102904502439e-10
iteration 1187 res= 2.8072174830953583e-10
iteration 1188 res= 2.7659479223618297e-10
iteration 1189 res= 2.7252850473922185e-10
iteration 1190 res= 2.685219935815019e-10
iteration 1191 res= 2.645743885718031e-10
iteration 1192 res= 2.606848176016478e-10
iteration 1193 res= 2.568524244981822e-10
iteration 1194 res= 2.5307637336690704e-10
iteration 1195 res= 2.493558338898998e-10
iteration 1196 res= 2.456899911960281e-10
iteration 1197 res= 2.420780514151654e-10
iteration 1198 res= 2.385191956743859e-10
iteration 1199 res= 2.3501267074437466e-10
iteration 1200 res= 2.3155768961973023e-10
iteration 1201 res= 2.2815350071087102e-10
iteration 1202 res= 2.2479935920463423e-10
iteration 1203 res= 2.214945364346569e-10
iteration 1204 res= 2.1823828715912532e-10
iteration 1205 res= 2.1502991194758025e-10
iteration 1206 res= 2.1186870509874152e-10
iteration 1207 res= 2.0875396709234362e-10
iteration 1208 res= 2.0568503030573963e-10
iteration 1209 res= 2.0266120087353162e-10
iteration 1210 res= 1.9968183506859101e-10
iteration 1211 res= 1.9674626347896582e-10
iteration 1212 res= 1.9385384567491351e-10
iteration 1213 res= 1.910039534896972e-10
iteration 1214 res= 1.881959516400044e-10
iteration 1215 res= 1.854292376115201e-10
iteration 1216 res= 1.82703201943727e-10
iteration 1217 res= 1.8001723299001426e-10
iteration 1218 res= 1.7737076233242294e-10
iteration 1219 res= 1.7476318860308643e-10
iteration 1220 res= 1.721939507829095e-10
iteration 1221 res= 1.6966248273726761e-10
iteration 1222 res= 1.6716823543691592e-10
iteration 1223 res= 1.6471065270073616e-10
needed 1223 iterations
</pre></div>
</div>
</div>
</div>
<p>By situation is not considerably improved by the diagonal preconditioner. However, if we have a bilinear-form with variable coefficient, or large coefficients in the Robin - boundary condition such as</p>
<div class="math notranslate nohighlight">
\[
A(u,v) = \int_\Omega \nabla u \nabla v \, dx + 10^8 \int_{\Gamma_R} u v \, ds,
\]</div>
<p>the Jacobi preconditioner captures these parameters (experiment in  excercise, theory soon).</p>
</section>
<section id="the-preconditioned-gradient-method">
<h2><span class="section-number">34.2. </span>The preconditioned gradient method<a class="headerlink" href="#the-preconditioned-gradient-method" title="Link to this heading">#</a></h2>
<p>To introduce the preconditioner into the gradient method we proceed as follows. Since <span class="math notranslate nohighlight">\(C\)</span> is SPD, we are allowed to form its square-root</p>
<div class="math notranslate nohighlight">
\[
C^{1/2}
\]</div>
<p>as well as its inverse. The linear system <span class="math notranslate nohighlight">\(A x = b\)</span> is equivalent to</p>
<div class="math notranslate nohighlight">
\[
C^{-1/2} A C^{-1/2} \; C^{1/2} x = C^{-1/2} b.
\]</div>
<p>With the definition of transformed quantities</p>
<div class="math notranslate nohighlight">
\[
\tilde A = C^{-1/2} A C^{-1/2}, \qquad
\tilde b = C^{-1/2} b, \qquad
\tilde x = C^{1/2} x
\]</div>
<p>we have the linear system</p>
<div class="math notranslate nohighlight">
\[
\tilde A \tilde x = \tilde b
\]</div>
<p>The transformed matrix <span class="math notranslate nohighlight">\(\tilde A\)</span> is SPD as well.</p>
<p>We apply the gradient method for the transformed system:</p>
<p>Given <span class="math notranslate nohighlight">\(\tilde x^0\)</span> <br>
<span class="math notranslate nohighlight">\(\tilde r^0 = \tilde b - \tilde A \tilde x^0\)</span> <br>
for <span class="math notranslate nohighlight">\(k = 0, 1, 2, \ldots\)</span> <br>
<span class="math notranslate nohighlight">\(\qquad \tilde p = \tilde A \tilde r^k\)</span> <br>
<span class="math notranslate nohighlight">\(\qquad \alpha = \frac{{\tilde r^k}^T \tilde r^k }{ {\tilde r^k}^T \tilde p}\)</span> <br>
<span class="math notranslate nohighlight">\(\qquad \tilde x^{k+1} = \tilde x^k + \alpha \tilde r^k\)</span> <br>
<span class="math notranslate nohighlight">\(\qquad \tilde r^{k+1} = \tilde r^k - \alpha \tilde p\)</span> <br></p>
<p>The error analysis of the gradient method provides</p>
<div class="math notranslate nohighlight">
\[
\| \tilde x^\ast - \tilde x^{k+1} \|_{\tilde A} \leq \rho
\| \tilde x^\ast - \tilde x^{k} \|_{\tilde A},
\]</div>
<p>and substituting back</p>
<div class="math notranslate nohighlight">
\[
\| x^\ast -  x^{k+1} \|_A \leq \rho \|  x^\ast -  x^{k} \|_A
\]</div>
<p>Since we cannot compute with the transformed system
we transform back via</p>
<div class="math notranslate nohighlight">
\[
\tilde x^k = C^{1/2} x^k, \qquad \tilde r^k = C^{-1/2} r, 
\qquad \tilde p = C^{-1/2} p
\]</div>
<p>and obtain</p>
<p>Given <span class="math notranslate nohighlight">\(x^0\)</span> <br>
<span class="math notranslate nohighlight">\(C^{-1/2} r^0 = C^{-1/2} b  - C^{-1/2} A C^{-1/2} C^{1/2} x^0\)</span> <br>
for <span class="math notranslate nohighlight">\(k = 0, 1, 2, \ldots\)</span> <br>
<span class="math notranslate nohighlight">\(\qquad C^{-1/2} p = C^{-1/2} A C^{-1/2} C^{-1/2} r^k\)</span> <br>
<span class="math notranslate nohighlight">\(\qquad \alpha = \frac{\{C^{-1/2} r^k \}^T C^{-1/2} r^k \, }{ \, \{ C^{-1/2} r^k\}^T C^{-1/2} p}\)</span> <br>
<span class="math notranslate nohighlight">\(\qquad C^{1/2} x^{k+1} = C^{1/2} x^k + \alpha C^{-1/2} r^k\)</span> <br>
<span class="math notranslate nohighlight">\(\qquad C^{-1/2} r^{k+1} = C^{-1/2} r^k - \alpha C^{-1/2} p\)</span> <br></p>
<p>now we simplify, and introduce <span class="math notranslate nohighlight">\(w = C^{-1} r\)</span></p>
<p>Given <span class="math notranslate nohighlight">\(x^0\)</span> <br>
<span class="math notranslate nohighlight">\(r^0 = b - A x^0\)</span> <br>
for <span class="math notranslate nohighlight">\(k = 0, 1, 2, \ldots\)</span> <br>
<span class="math notranslate nohighlight">\(\qquad w = C^{-1} r^k\)</span> <br>
<span class="math notranslate nohighlight">\(\qquad p = A w\)</span> <br>
<span class="math notranslate nohighlight">\(\qquad \alpha = \frac{w^T r^k}{w^T p^k}\)</span> <br>
<span class="math notranslate nohighlight">\(\qquad x^{k+1} = x^k + \alpha w\)</span> <br>
<span class="math notranslate nohighlight">\(\qquad r^{k+1} = r^k - \alpha p\)</span> <br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">vec</span><span class="o">.</span><span class="n">CreateVector</span><span class="p">()</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">vec</span><span class="o">.</span><span class="n">CreateVector</span><span class="p">()</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">vec</span><span class="o">.</span><span class="n">CreateVector</span><span class="p">()</span>

<span class="n">gfu</span><span class="o">.</span><span class="n">vec</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">r</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">vec</span>
<span class="n">w</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">pre</span><span class="o">*</span><span class="n">r</span>
<span class="n">err0</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">InnerProduct</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">w</span><span class="p">))</span>
<span class="n">its</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">w</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">pre</span><span class="o">*</span><span class="n">r</span>
    <span class="n">p</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">mat</span> <span class="o">*</span> <span class="n">w</span>
    <span class="n">err2</span> <span class="o">=</span> <span class="n">InnerProduct</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">err2</span> <span class="o">/</span> <span class="n">InnerProduct</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>

    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;iteration&quot;</span><span class="p">,</span> <span class="n">its</span><span class="p">,</span> <span class="s2">&quot;res=&quot;</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">err2</span><span class="p">))</span>
    <span class="n">gfu</span><span class="o">.</span><span class="n">vec</span><span class="o">.</span><span class="n">data</span> <span class="o">+=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">w</span>
    <span class="n">r</span><span class="o">.</span><span class="n">data</span> <span class="o">-=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">p</span>
    <span class="k">if</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">err2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-8</span> <span class="o">*</span> <span class="n">err0</span> <span class="ow">or</span> <span class="n">its</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">:</span> <span class="k">break</span>
    <span class="n">its</span> <span class="o">=</span> <span class="n">its</span><span class="o">+</span><span class="mi">1</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;needed&quot;</span><span class="p">,</span> <span class="n">its</span><span class="p">,</span> <span class="s2">&quot;iterations&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iteration 0 res= 0.01669736401134929
iteration 1 res= 0.04676402896143131
iteration 2 res= 0.012516466249535998
iteration 3 res= 0.012622641499022489
iteration 4 res= 0.009831356625371953
iteration 5 res= 0.01132518188646685
iteration 6 res= 0.009087364081317776
iteration 7 res= 0.010523050734198366
iteration 8 res= 0.00847976403398601
iteration 9 res= 0.009827149402425048
iteration 10 res= 0.007935252160575381
iteration 11 res= 0.009196223735765958
iteration 12 res= 0.00743526618983477
iteration 13 res= 0.008615753848144331
iteration 14 res= 0.006972398170471832
iteration 15 res= 0.008078297094028186
iteration 16 res= 0.006542425460609999
iteration 17 res= 0.007578993495084558
iteration 18 res= 0.006142282130779068
iteration 19 res= 0.007114189915988235
iteration 20 res= 0.005769442468507675
iteration 21 res= 0.006680914537617769
iteration 22 res= 0.0054216978119303
iteration 23 res= 0.006276632976097386
iteration 24 res= 0.005097060273237553
iteration 25 res= 0.005899115363297404
iteration 26 res= 0.004793716388179277
iteration 27 res= 0.005546355056869554
iteration 28 res= 0.004510004737923733
iteration 29 res= 0.005216516445242014
iteration 30 res= 0.004244405499794099
iteration 31 res= 0.004907902891156098
iteration 32 res= 0.003995534393292754
iteration 33 res= 0.004618940048328719
iteration 34 res= 0.0037621364026970278
iteration 35 res= 0.00434816976519926
iteration 36 res= 0.003543077332266211
iteration 37 res= 0.004094249037689805
iteration 38 res= 0.003337333219403732
iteration 39 res= 0.003855949090487925
iteration 40 res= 0.0031439785777843455
iteration 41 res= 0.0036321517205538086
iteration 42 res= 0.00296217457550339
iteration 43 res= 0.003421842325921411
iteration 44 res= 0.0027911579789351108
iteration 45 res= 0.0032241005312898838
iteration 46 res= 0.0026302313246853067
iteration 47 res= 0.0030380897923316594
iteration 48 res= 0.002478754475564147
iteration 49 res= 0.002863047157896193
iteration 50 res= 0.0023361375162573718
iteration 51 res= 0.0026982739254084414
iteration 52 res= 0.002201834839868515
iteration 53 res= 0.0025431275127221517
iteration 54 res= 0.0020753402393575877
iteration 55 res= 0.0023970145886765266
iteration 56 res= 0.001956182820295164
iteration 57 res= 0.0022593853525817043
iteration 58 res= 0.0018439235727172178
iteration 59 res= 0.002129728792241599
iteration 60 res= 0.0017381524674373377
iteration 61 res= 0.002007568742539311
iteration 62 res= 0.0016384859691664603
iteration 63 res= 0.0018924605844179974
iteration 64 res= 0.0015445648822572083
iteration 65 res= 0.0017839884507471727
iteration 66 res= 0.0014560524640193078
iteration 67 res= 0.0016817628325521035
iteration 68 res= 0.001372632755566301
iteration 69 res= 0.0015854185027506544
iteration 70 res= 0.0012940090916739257
iteration 71 res= 0.001494612693835005
iteration 72 res= 0.0012199027598578656
iteration 73 res= 0.0014090234810199122
iteration 74 res= 0.0011500517854504146
iteration 75 res= 0.0013283483338839437
iteration 76 res= 0.0010842098243986475
iteration 77 res= 0.0012523028081801117
iteration 78 res= 0.001022145149233822
iteration 79 res= 0.0011806193559487047
iteration 80 res= 0.0009636397164868479
iteration 81 res= 0.0011130462368732716
iteration 82 res= 0.0009084883059816959
iteration 83 res= 0.0010493465174072057
iteration 84 res= 0.0008564977241003334
iteration 85 res= 0.0009892971468854826
iteration 86 res= 0.0008074860644057111
iteration 87 res= 0.0009326881018637065
iteration 88 res= 0.000761282020026214
iteration 89 res= 0.0008793215914698763
iteration 90 res= 0.0007177242430137868
iteration 91 res= 0.0008290113177414226
iteration 92 res= 0.0006766607465384574
iteration 93 res= 0.0007815817858437647
iteration 94 res= 0.0006379483463111673
iteration 95 res= 0.0007368676597943839
iteration 96 res= 0.0006014521380619744
iteration 97 res= 0.0006947131598971899
iteration 98 res= 0.0005670450082623496
iteration 99 res= 0.0006549714985615502
iteration 100 res= 0.0005346071755838413
iteration 101 res= 0.000617504351565
iteration 102 res= 0.000504025760842627
iteration 103 res= 0.0005821813621376704
iteration 104 res= 0.0004751943833993671
iteration 105 res= 0.0005488796755142689
iteration 106 res= 0.00044801278217334066
iteration 107 res= 0.000517483501826816
iteration 108 res= 0.00042238645959449903
iteration 109 res= 0.0004878837054063622
iteration 110 res= 0.0003982263469611216
iteration 111 res= 0.0004599774187308751
iteration 112 res= 0.0003754484897976262
iteration 113 res= 0.0004336676794041003
iteration 114 res= 0.00035397375191948744
iteration 115 res= 0.00040886308868026065
iteration 116 res= 0.00033372753701238256
iteration 117 res= 0.00038547749016481787
iteration 118 res= 0.00031463952662240895
iteration 119 res= 0.00036342966742455737
iteration 120 res= 0.00029664343353497265
iteration 121 res= 0.0003426430593327931
iteration 122 res= 0.0002796767695929558
iteration 123 res= 0.0003230454920590457
iteration 124 res= 0.00026368062707105136
iteration 125 res= 0.00030456892668833155
iteration 126 res= 0.0002485994727835388
iteration 127 res= 0.00028714922152425906
iteration 128 res= 0.00023438095415798498
iteration 129 res= 0.0002707259081932471
iteration 130 res= 0.00022097571655799807
iteration 131 res= 0.0002552419807251049
iteration 132 res= 0.00020833723118473038
iteration 133 res= 0.00024064369683850922
iteration 134 res= 0.0001964216329297794
iteration 135 res= 0.0002268803907090897
iteration 136 res= 0.0001851875675918319
iteration 137 res= 0.00021390429654331603
iteration 138 res= 0.00017459604790616952
iteration 139 res= 0.00020167038232353564
iteration 140 res= 0.00016461031787027604
iteration 141 res= 0.00019013619312866213
iteration 142 res= 0.00015519572488051722
iteration 143 res= 0.00017926170347142744
iteration 144 res= 0.0001463195992243994
iteration 145 res= 0.00016900917812704295
iteration 146 res= 0.00013795114050045652
iteration 147 res= 0.00015934304095976715
iteration 148 res= 0.0001300613105635287
iteration 149 res= 0.00015022975128344045
iteration 150 res= 0.00012262273261722523
iteration 151 res= 0.00014163768731969116
iteration 152 res= 0.00011560959609784749
iteration 153 res= 0.00013353703634339623
iteration 154 res= 0.00010899756701509543
iteration 155 res= 0.00012589969112920913
iteration 156 res= 0.00010276370343461273
iteration 157 res= 0.00011869915233569103
iteration 158 res= 9.688637580591863e-05
iteration 159 res= 0.00011191043648489634
iteration 160 res= 9.134519185663677e-05
iteration 161 res= 0.00010550998921526227
iteration 162 res= 8.612092579022607e-05
iteration 163 res= 9.947560350444349e-05
iteration 164 res= 8.119545153972676e-05
iteration 165 res= 9.378634257637925e-05
iteration 166 res= 7.655167984441922e-05
iteration 167 res= 8.842246722347219e-05
iteration 168 res= 7.217349892981761e-05
iteration 169 res= 8.336536729035545e-05
iteration 170 res= 6.804571858413592e-05
iteration 171 res= 7.859749708039546e-05
iteration 172 res= 6.415401743632766e-05
iteration 173 res= 7.410231445988267e-05
iteration 174 res= 6.0484893252057213e-05
iteration 175 res= 6.986422344784918e-05
iteration 176 res= 5.7025616074553437e-05
iteration 177 res= 6.586852009168126e-05
iteration 178 res= 5.376418404726975e-05
iteration 179 res= 6.210134144020343e-05
iteration 180 res= 5.0689281764664425e-05
iteration 181 res= 5.854961743674958e-05
iteration 182 res= 4.779024100625566e-05
iteration 183 res= 5.520102556494434e-05
iteration 184 res= 4.5057003717434264e-05
iteration 185 res= 5.2043948089530654e-05
iteration 186 res= 4.2480087108359866e-05
iteration 187 res= 4.906743174363601e-05
iteration 188 res= 4.0050550749655826e-05
iteration 189 res= 4.626114972240112e-05
iteration 190 res= 3.775996555057947e-05
iteration 191 res= 4.361536585093303e-05
iteration 192 res= 3.560038451190295e-05
iteration 193 res= 4.1120900802117854e-05
iteration 194 res= 3.356431515192084e-05
iteration 195 res= 3.876910024696664e-05
iteration 196 res= 3.164469350982427e-05
iteration 197 res= 3.655180482689158e-05
iteration 198 res= 2.983485963617024e-05
iteration 199 res= 3.446132184364965e-05
iteration 200 res= 2.8128534485347307e-05
iteration 201 res= 3.249039856866386e-05
iteration 202 res= 2.6519798129813868e-05
iteration 203 res= 3.063219707906238e-05
iteration 204 res= 2.5003069220480436e-05
iteration 205 res= 2.888027053308291e-05
iteration 206 res= 2.3573085621938148e-05
iteration 207 res= 2.722854080249132e-05
iteration 208 res= 2.222488615531824e-05
iteration 209 res= 2.5671277384379035e-05
iteration 210 res= 2.0953793385415173e-05
iteration 211 res= 2.4203077519147187e-05
iteration 212 res= 1.9755397392333632e-05
iteration 213 res= 2.2818847445675897e-05
iteration 214 res= 1.8625540471338818e-05
iteration 215 res= 2.151378472862585e-05
iteration 216 res= 1.7560302707812854e-05
iteration 217 res= 2.0283361596542387e-05
iteration 218 res= 1.655598837725868e-05
iteration 219 res= 1.9123309232942095e-05
iteration 220 res= 1.560911312315752e-05
iteration 221 res= 1.802960296587e-05
iteration 222 res= 1.4716391868186244e-05
iteration 223 res= 1.6998448304535112e-05
iteration 224 res= 1.3874727416846525e-05
iteration 225 res= 1.602626777457202e-05
iteration 226 res= 1.308119970995835e-05
iteration 227 res= 1.5109688506248361e-05
iteration 228 res= 1.233305569373212e-05
iteration 229 res= 1.4245530532551711e-05
iteration 230 res= 1.162769976826744e-05
iteration 231 res= 1.3430795756552584e-05
iteration 232 res= 1.0962684782337147e-05
iteration 233 res= 1.2662657549763452e-05
iteration 234 res= 1.0335703543211018e-05
iteration 235 res= 1.1938450945403465e-05
iteration 236 res= 9.744580812061325e-06
iteration 237 res= 1.1255663392542698e-05
iteration 238 res= 9.187265757176984e-06
iteration 239 res= 1.0611926039046362e-05
iteration 240 res= 8.661824838802052e-06
iteration 241 res= 1.0005005513074448e-05
iteration 242 res= 8.16643510091193e-06
iteration 243 res= 9.432796174622032e-06
iteration 244 res= 7.699377846652684e-06
iteration 245 res= 8.893312810216628e-06
iteration 246 res= 7.259032675500182e-06
iteration 247 res= 8.384683745426647e-06
iteration 248 res= 6.843871861450908e-06
iteration 249 res= 7.905144351284726e-06
iteration 250 res= 6.452455052739529e-06
iteration 251 res= 7.453030922096421e-06
iteration 252 res= 6.083424274693946e-06
iteration 253 res= 7.026774903393535e-06
iteration 254 res= 5.735499218390351e-06
iteration 255 res= 6.624897450006009e-06
iteration 256 res= 5.407472798762443e-06
iteration 257 res= 6.246004295371883e-06
iteration 258 res= 5.098206966753873e-06
iteration 259 res= 5.888780914284616e-06
iteration 260 res= 4.806628760984348e-06
iteration 261 res= 5.551987962295189e-06
iteration 262 res= 4.531726585230953e-06
iteration 263 res= 5.23445697594625e-06
iteration 264 res= 4.272546698809593e-06
iteration 265 res= 4.935086318920653e-06
iteration 266 res= 4.028189907680227e-06
iteration 267 res= 4.652837360039694e-06
iteration 268 res= 3.7978084447959497e-06
iteration 269 res= 4.386730869851074e-06
iteration 270 res= 3.5806030288724944e-06
iteration 271 res= 4.1358436233047445e-06
iteration 272 res= 3.3758200913738635e-06
iteration 273 res= 3.8993051967299636e-06
iteration 274 res= 3.182749162093341e-06
iteration 275 res= 3.6762949480009497e-06
iteration 276 res= 3.000720404259396e-06
iteration 277 res= 3.4660391694141072e-06
iteration 278 res= 2.8291022906147763e-06
iteration 279 res= 3.2678084033989876e-06
iteration 280 res= 2.6672994124061805e-06
iteration 281 res= 3.0809149117501476e-06
iteration 282 res= 2.514750413682989e-06
iteration 283 res= 2.9047102895996285e-06
iteration 284 res= 2.370926043738355e-06
iteration 285 res= 2.738583215851981e-06
iteration 286 res= 2.2353273209357724e-06
iteration 287 res= 2.5819573322772307e-06
iteration 288 res= 2.107483801550723e-06
iteration 289 res= 2.434289243903492e-06
iteration 290 res= 1.9869519476213424e-06
iteration 291 res= 2.2950666337718277e-06
iteration 292 res= 1.8733135881455138e-06
iteration 293 res= 2.163806485512686e-06
iteration 294 res= 1.7661744682857149e-06
iteration 295 res= 2.0400534075773544e-06
iteration 296 res= 1.6651628815482208e-06
iteration 297 res= 1.923378053310532e-06
iteration 298 res= 1.5699283801911588e-06
iteration 299 res= 1.813375631382626e-06
iteration 300 res= 1.4801405593873478e-06
iteration 301 res= 1.7096645014138944e-06
iteration 302 res= 1.3954879109236771e-06
iteration 303 res= 1.611884849918118e-06
iteration 304 res= 1.3156767424600878e-06
iteration 305 res= 1.5196974419721263e-06
iteration 306 res= 1.2404301585986434e-06
iteration 307 res= 1.432782444280242e-06
iteration 308 res= 1.1694871002276236e-06
iteration 309 res= 1.3508383155503936e-06
iteration 310 res= 1.1026014388077513e-06
iteration 311 res= 1.2735807603322068e-06
iteration 312 res= 1.0395411224582957e-06
iteration 313 res= 1.2007417426875057e-06
iteration 314 res= 9.800873708804834e-07
iteration 315 res= 1.132068556271282e-06
iteration 316 res= 9.240339163251061e-07
iteration 317 res= 1.0673229475968927e-06
iteration 318 res= 8.711862879709443e-07
iteration 319 res= 1.0062802894437463e-06
iteration 320 res= 8.213611372312436e-07
iteration 321 res= 9.487288015397145e-07
iteration 322 res= 7.743856016474731e-07
iteration 323 res= 8.944688158145173e-07
iteration 324 res= 7.300967051634726e-07
iteration 325 res= 8.433120836749668e-07
iteration 326 res= 6.883407926993034e-07
iteration 327 res= 7.950811228987381e-07
iteration 328 res= 6.489729970631251e-07
iteration 329 res= 7.496086018807968e-07
iteration 330 res= 6.118567363516179e-07
iteration 331 res= 7.06736759096192e-07
iteration 332 res= 5.768632400952301e-07
iteration 333 res= 6.663168557651118e-07
iteration 334 res= 5.438711025042755e-07
iteration 335 res= 6.282086598212932e-07
iteration 336 res= 5.127658612659156e-07
iteration 337 res= 5.922799593934622e-07
iteration 338 res= 4.834396004307151e-07
iteration 339 res= 5.584061041118961e-07
iteration 340 res= 4.557905760110307e-07
iteration 341 res= 5.264695726487232e-07
iteration 342 res= 4.297228629922922e-07
iteration 343 res= 4.963595649915877e-07
iteration 344 res= 4.0514602253252196e-07
iteration 345 res= 4.6797161803612534e-07
iteration 346 res= 3.8197478819548163e-07
iteration 347 res= 4.412072431635926e-07
iteration 348 res= 3.601287701288688e-07
iteration 349 res= 4.1597358454626395e-07
iteration 350 res= 3.395321761612434e-07
iteration 351 res= 3.9218309699513424e-07
iteration 352 res= 3.2011354885006636e-07
iteration 353 res= 3.6975324223225383e-07
iteration 354 res= 3.0180551756856405e-07
iteration 355 res= 3.486062025339464e-07
iteration 356 res= 2.845445647713189e-07
iteration 357 res= 3.2866861075143356e-07
iteration 358 res= 2.6827080562766853e-07
iteration 359 res= 3.098712957722015e-07
iteration 360 res= 2.5292778025837837e-07
iteration 361 res= 2.921490425390183e-07
iteration 362 res= 2.3846225785477897e-07
iteration 363 res= 2.754403657940185e-07
iteration 364 res= 2.2482405200077983e-07
iteration 365 res= 2.5968729676288245e-07
iteration 366 res= 2.119658465570438e-07
iteration 367 res= 2.448351820390414e-07
iteration 368 res= 1.9984303150324743e-07
iteration 369 res= 2.3083249397015583e-07
iteration 370 res= 1.8841354816889843e-07
iteration 371 res= 2.1763065188903096e-07
iteration 372 res= 1.776377433157622e-07
iteration 373 res= 2.0518385356874574e-07
iteration 374 res= 1.6747823156564813e-07
iteration 375 res= 1.9344891631725305e-07
iteration 376 res= 1.578997656962698e-07
iteration 377 res= 1.8238512716014438e-07
iteration 378 res= 1.4886911435518196e-07
iteration 379 res= 1.7195410159180882e-07
iteration 380 res= 1.4035494676754097e-07
iteration 381 res= 1.6211965040493778e-07
iteration 382 res= 1.3232772403769249e-07
iteration 383 res= 1.5284765413635805e-07
iteration 384 res= 1.2475959666747306e-07
iteration 385 res= 1.441059446935957e-07
iteration 386 res= 1.1762430793567542e-07
iteration 387 res= 1.3586419375149043e-07
iteration 388 res= 1.1089710280346499e-07
iteration 389 res= 1.2809380753166492e-07
iteration 390 res= 1.0455464202970551e-07
iteration 391 res= 1.207678275997978e-07
iteration 392 res= 9.857492119822699e-08
iteration 393 res= 1.1386083733653013e-07
iteration 394 res= 9.293719437611101e-08
iteration 395 res= 1.0734887375751532e-07
iteration 396 res= 8.762190213813422e-08
iteration 397 res= 1.0120934437668419e-07
iteration 398 res= 8.261060370765983e-08
iteration 399 res= 9.542094882429116e-08
iteration 400 res= 7.788591297854809e-08
iteration 401 res= 8.99636049478054e-08
iteration 402 res= 7.343143819612081e-08
iteration 403 res= 8.481837913926129e-08
iteration 404 res= 6.923172508791056e-08
iteration 405 res= 7.996742064734932e-08
iteration 406 res= 6.527220324689352e-08
iteration 407 res= 7.539389964634911e-08
iteration 408 res= 6.153913558118854e-08
iteration 409 res= 7.108194884704324e-08
iteration 410 res= 5.8019570654844243e-08
iteration 411 res= 6.701660844703723e-08
iteration 412 res= 5.4701297754366994e-08
iteration 413 res= 6.318377422949732e-08
iteration 414 res= 5.157280452509673e-08
iteration 415 res= 5.957014863024164e-08
iteration 416 res= 4.8623237030456596e-08
iteration 417 res= 5.616319460341658e-08
iteration 418 res= 4.584236209550613e-08
iteration 419 res= 5.295109212570168e-08
iteration 420 res= 4.3220531804153075e-08
iteration 421 res= 4.9922697188139195e-08
iteration 422 res= 4.074865002685178e-08
iteration 423 res= 4.70675031333153e-08
iteration 424 res= 3.8418140862659374e-08
iteration 425 res= 4.437560420375716e-08
iteration 426 res= 3.622091888616355e-08
iteration 427 res= 4.183766117508102e-08
iteration 428 res= 3.4149361096057165e-08
iteration 429 res= 3.944486895465966e-08
iteration 430 res= 3.219628046803838e-08
iteration 431 res= 3.718892603339684e-08
iteration 432 res= 3.035490102028133e-08
iteration 433 res= 3.506200568462522e-08
iteration 434 res= 2.8618834304970106e-08
iteration 435 res= 3.3056728810205274e-08
iteration 436 res= 2.6982057244335956e-08
iteration 437 res= 3.116613833961885e-08
iteration 438 res= 2.5438891234302623e-08
iteration 439 res= 2.9383675093237095e-08
iteration 440 res= 2.3983982443242275e-08
iteration 441 res= 2.7703155026024114e-08
iteration 442 res= 2.2612283237491136e-08
iteration 443 res= 2.6118747772725218e-08
iteration 444 res= 2.1319034669182457e-08
iteration 445 res= 2.4624956420105627e-08
iteration 446 res= 2.0099749965640788e-08
iteration 447 res= 2.3216598436061256e-08
iteration 448 res= 1.895019896305581e-08
iteration 449 res= 2.1888787689437643e-08
iteration 450 res= 1.78663934304302e-08
iteration 451 res= 2.06369174981768e-08
iteration 452 res= 1.6844573232884746e-08
iteration 453 res= 1.9456644646979716e-08
iteration 454 res= 1.5881193286315854e-08
iteration 455 res= 1.834387431903542e-08
iteration 456 res= 1.497291125814638e-08
iteration 457 res= 1.7294745889539256e-08
iteration 458 res= 1.4116575971498682e-08
iteration 459 res= 1.630561953171255e-08
iteration 460 res= 1.3309216472559861e-08
iteration 461 res= 1.5373063588854875e-08
iteration 462 res= 1.2548031723209533e-08
iteration 463 res= 1.449384266861774e-08
iteration 464 res= 1.1830380883149914e-08
iteration 465 res= 1.3664906418194127e-08
iteration 466 res= 1.1153774147823345e-08
iteration 467 res= 1.2883378941480913e-08
iteration 468 res= 1.0515864110330373e-08
iteration 469 res= 1.2146548821498085e-08
iteration 470 res= 9.914437617379643e-09
iteration 471 res= 1.1451859713448763e-08
iteration 472 res= 9.347408091014777e-09
iteration 473 res= 1.0796901475783853e-08
iteration 474 res= 8.812808289479418e-09
iteration 475 res= 1.0179401808501475e-08
iteration 476 res= 8.308783482104997e-09
iteration 477 res= 9.59721836967138e-09
iteration 478 res= 7.833585014542478e-09
iteration 479 res= 9.048331342833426e-09
iteration 480 res= 7.38556424201328e-09
iteration 481 res= 8.530836429483711e-09
iteration 482 res= 6.963166809531534e-09
iteration 483 res= 8.042938242336543e-09
iteration 484 res= 6.5649272592536575e-09
iteration 485 res= 7.582944076440986e-09
iteration 486 res= 6.189463946245992e-09
iteration 487 res= 7.14925803654157e-09
iteration 488 res= 5.835474245031408e-09
iteration 489 res= 6.740375500308825e-09
iteration 490 res= 5.5017300302845614e-09
iteration 491 res= 6.354877898230372e-09
iteration 492 res= 5.187073415996593e-09
iteration 493 res= 5.99142779205208e-09
iteration 494 res= 4.890412738326808e-09
iteration 495 res= 5.648764234694515e-09
iteration 496 res= 4.610718768204336e-09
iteration 497 res= 5.3256983955464495e-09
iteration 498 res= 4.347021140539813e-09
iteration 499 res= 5.021109435957915e-09
iteration 500 res= 4.0984049876586875e-09
iteration 501 res= 4.733940620623322e-09
iteration 502 res= 3.864007765276214e-09
iteration 503 res= 4.463195651363508e-09
iteration 504 res= 3.64301626000226e-09
iteration 505 res= 4.207935210587276e-09
iteration 506 res= 3.434663767993801e-09
iteration 507 res= 3.967273702440287e-09
iteration 508 res= 3.2382274349667893e-09
iteration 509 res= 3.740376180335177e-09
iteration 510 res= 3.053025748338861e-09
iteration 511 res= 3.526455450203314e-09
iteration 512 res= 2.8784161728021692e-09
iteration 513 res= 3.324769339418241e-09
iteration 514 res= 2.7137929211232825e-09
iteration 515 res= 3.134618121915689e-09
iteration 516 res= 2.55858485243615e-09
iteration 517 res= 2.9553420905768984e-09
iteration 518 res= 2.4122534907365335e-09
iteration 519 res= 2.7863192684529454e-09
iteration 520 res= 2.2742911567033215e-09
iteration 521 res= 2.626963250889403e-09
iteration 522 res= 2.1442192063652715e-09
iteration 523 res= 2.4767211710648918e-09
iteration 524 res= 2.021586370502467e-09
iteration 525 res= 2.3350717818851255e-09
iteration 526 res= 1.90596718902123e-09
iteration 527 res= 2.2015236475779014e-09
iteration 528 res= 1.796960534870733e-09
iteration 529 res= 2.0756134387149014e-09
iteration 530 res= 1.6941882223802265e-09
iteration 531 res= 1.9569043247451492e-09
iteration 532 res= 1.5972936951886675e-09
iteration 533 res= 1.8449844584631633e-09
iteration 534 res= 1.5059407892146672e-09
iteration 535 res= 1.7394655471538818e-09
iteration 536 res= 1.419812566375043e-09
iteration 537 res= 1.639981505457093e-09
iteration 538 res= 1.3386102150056933e-09
iteration 539 res= 1.5461871852776562e-09
iteration 540 res= 1.2620520131699322e-09
iteration 541 res= 1.4577571783350777e-09
iteration 542 res= 1.1898723512576114e-09
iteration 543 res= 1.3743846871980406e-09
iteration 544 res= 1.1218208104840477e-09
iteration 545 res= 1.2957804608870685e-09
iteration 546 res= 1.0576612940917242e-09
iteration 547 res= 1.221671791352521e-09
iteration 548 res= 9.971712082405593e-10
iteration 549 res= 1.151801567346333e-09
iteration 550 res= 9.401406897449579e-10
iteration 551 res= 1.0859273824050009e-09
iteration 552 res= 8.863718779783506e-10
iteration 553 res= 1.023820693849078e-09
iteration 554 res= 8.356782284191972e-10
iteration 555 res= 9.6526602988143e-10
iteration 556 res= 7.87883865456871e-10
iteration 557 res= 9.100602420333637e-10
iteration 558 res= 7.428229722120652e-10
iteration 559 res= 8.580118003650864e-10
iteration 560 res= 7.003392152547791e-10
iteration 561 res= 8.089401289752734e-10
iteration 562 res= 6.60285202224005e-10
iteration 563 res= 7.62674979514373e-10
iteration 564 res= 6.225219704673971e-10
iteration 565 res= 7.190558405281299e-10
iteration 566 res= 5.869185049268122e-10
iteration 567 res= 6.779313805821166e-10
iteration 568 res= 5.533512835970911e-10
iteration 569 res= 6.391589232352464e-10
iteration 570 res= 5.217038489810967e-10
iteration 571 res= 6.026039520407712e-10
iteration 572 res= 4.918664040542255e-10
iteration 573 res= 5.681396438574068e-10
iteration 574 res= 4.637354313366405e-10
iteration 575 res= 5.356464288514695e-10
iteration 576 res= 4.3721333375164203e-10
iteration 577 res= 5.05011575663507e-10
iteration 578 res= 4.122080960241723e-10
iteration 579 res= 4.761288003002023e-10
iteration 580 res= 3.886329654447213e-10
iteration 581 res= 4.488978973946549e-10
iteration 582 res= 3.6640615089108093e-10
iteration 583 res= 4.2322439255573154e-10
iteration 584 res= 3.4545053906373666e-10
iteration 585 res= 3.9901921460035927e-10
iteration 586 res= 3.256934269504133e-10
iteration 587 res= 3.761983865316117e-10
iteration 588 res= 3.0706626959158623e-10
iteration 589 res= 3.546827341904665e-10
iteration 590 res= 2.89504442271868e-10
iteration 591 res= 3.3439761157044293e-10
iteration 592 res= 2.7294701631221375e-10
iteration 593 res= 3.1527264184212576e-10
iteration 594 res= 2.5733654768508987e-10
iteration 595 res= 2.9724147318909537e-10
iteration 596 res= 2.4261887771922597e-10
iteration 597 res= 2.8024154860816174e-10
iteration 598 res= 2.287429452025222e-10
iteration 599 res= 2.642138888752549e-10
iteration 600 res= 2.1566060923122388e-10
iteration 601 res= 2.4910288792399457e-10
iteration 602 res= 2.0332648219076003e-10
iteration 603 res= 2.3485611992703133e-10
iteration 604 res= 1.9169777228879272e-10
iteration 605 res= 2.2142415741085098e-10
iteration 606 res= 1.8073413509416347e-10
iteration 607 res= 2.0876039977301113e-10
iteration 608 res= 1.7039753356666953e-10
iteration 609 res= 1.968209116068729e-10
iteration 610 res= 1.606521060920601e-10
needed 610 iterations
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="jacobi-and-gauss-seidel-preconditioners">
<h1><span class="section-number">35. </span>Jacobi and Gauss Seidel Preconditioners<a class="headerlink" href="#jacobi-and-gauss-seidel-preconditioners" title="Link to this heading">#</a></h1>
<p>For a given residual <span class="math notranslate nohighlight">\(r\)</span>, the Jacobi preconditioner computes</p>
<div class="math notranslate nohighlight">
\[
w = D^{-1} r
\]</div>
<p>with <span class="math notranslate nohighlight">\(D = \text{diag} A\)</span>. If <span class="math notranslate nohighlight">\(r_i\)</span> is the <span class="math notranslate nohighlight">\(i^{th}\)</span> component of the residual, the correction step of the <span class="math notranslate nohighlight">\(i^{th}\)</span> variable is <span class="math notranslate nohighlight">\(w_i = A_{ii}^{-1} r_i\)</span>. All these correction steps are computed for the same residual.</p>
<p>In contrast, the Gauss-Seidel iteration updates the <span class="math notranslate nohighlight">\(i^{th}\)</span> variable from the residual computed from all up to date variables:</p>
<p>for <span class="math notranslate nohighlight">\(i = 1, \ldots, n\)</span>: <br>
<span class="math notranslate nohighlight">\(\qquad \hat x_i = x_i + A_{ii}^{-1} \big( b_i - \sum_{j=1}^{i-1} A_{ij} \hat x_j - \sum_{j=i}^n A_{ij} x_j \big)\)</span></p>
<p>The method depends on the enumeration of variables. E.g, one could loop backwards, and thus obtains the so-called backward Gauss-Seidel iteration.</p>
<p>There holds for every <span class="math notranslate nohighlight">\(1 \leq i \leq n\)</span>:
$<span class="math notranslate nohighlight">\(
\sum_{j=1}^i A_{ij} \hat x_j = b_i - \sum_{j=i+1}^n A_{ij} x_j
\)</span>$</p>
<p>If we split the matrix</p>
<div class="math notranslate nohighlight">
\[
A = L + D + R
\]</div>
<p>with a strictly lower triangular matrix <span class="math notranslate nohighlight">\(L\)</span>, a diagonal matrix <span class="math notranslate nohighlight">\(D\)</span>, and a strictly upper diagonal matrix <span class="math notranslate nohighlight">\(R\)</span> we can write</p>
<div class="math notranslate nohighlight">
\[
(L+D) \hat x = b - R x
\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[
(L+D) \hat x = (L+D) x + b - A x
\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[
\hat x = x + (L+D)^{-1} (b - A x)
\]</div>
<p>This means we can interpret the Gauss-Seidel iteration as a preconditioned Richardson iteration, with preconditioner <span class="math notranslate nohighlight">\(C = L+D\)</span>. In general, this is not a symmetric preconditioner.</p>
<p>If we run the backward Gauss-Seidel iteration, the preconditioner becomes <span class="math notranslate nohighlight">\(C = D + R\)</span>. Now, we combine one step forward, with one step backward Gauss-Seidel:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
\tilde x &amp; = &amp; x + (L+D)^{-1} (b - A x) \\
\hat x &amp; = &amp; \tilde x + (D+R)^{-1} (b - A \tilde x)
\end{eqnarray*}\]</div>
<p>we can write</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
\hat x &amp; = &amp; (D+R)^{-1} (b - L \tilde x) \\
&amp; = &amp; (D+R)^{-1} \big(b - L (L+D)^{-1} (b - R x) \big) \\
&amp; = &amp; (D+R)^{-1} \big( (L+D)(L+D)^{-1} b - L (L+D)^{-1} b \big) + \ldots x \\
&amp; = &amp; (D+R)^{-1} D (L+D)^{-1} b + \ldots x \\
&amp; = &amp; x + (D+R)^{-1} D (L+D)^{-1} (b - A x)
\end{eqnarray*}\]</div>
<p>and observe that the combined forward-backward Gauss-Seidel iteration is a Richardson method with preconditioner</p>
<div class="math notranslate nohighlight">
\[
C_{FBGS}^{-1} = (D+R)^{-1} D (L+D)^{-1}.
\]</div>
<p>If <span class="math notranslate nohighlight">\(A\)</span> is symmetric, then <span class="math notranslate nohighlight">\((L+D)^T = D+R\)</span>, and <span class="math notranslate nohighlight">\(C_{FBGS}\)</span> is symmetric as well. If <span class="math notranslate nohighlight">\(A\)</span> is SPD, then we obtain</p>
<div class="math notranslate nohighlight">
\[
x^T C_{FBGS} x \geq x^T A x  \qquad \forall \, x
\]</div>
<p>i.e. the spectral constant <span class="math notranslate nohighlight">\(\gamma_2 = 1\)</span>, and choosing a damping parameter <span class="math notranslate nohighlight">\(\alpha = 1\)</span> is guaranteed to converge.</p>
<p>We prove this by calculation:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{eqnarray*}
C_{FBGS} &amp; = &amp; (L+D) D^{-1} (D+R) \\
&amp; = &amp; L + D + R + L D^{-1} R \\
&amp; = &amp; A + L D^{-1} R
\end{eqnarray*}\]</div>
<p>Since <span class="math notranslate nohighlight">\(x^T L D^{-1} R x = (R x)^T D^{-1} (R x) = \| R x \|_{D^{-1}}^2 \geq 0\)</span> we have proven that</p>
<div class="math notranslate nohighlight">
\[
C_{FBGS} \geq A
\]</div>
<p>The error propagation matrix of the FB - GS is</p>
<div class="math notranslate nohighlight">
\[
M_{FBGS} = \underbrace{(I - (D+R)^{-1} A)}_{M_{BGS}} \underbrace{ ( I - (D+L)^{-1} A) }_{M_{FBS}},
\]</div>
<p>and has norm <span class="math notranslate nohighlight">\(\| M_{FBGS} \|_A &lt; 1\)</span>. The error propagation matrices
of the forward and backward GS are <span class="math notranslate nohighlight">\(A\)</span>-adjoint to each other:</p>
<div class="math notranslate nohighlight">
\[
\left&lt; M_{FGS} x, y \right&gt;_A = \left&lt; x, M_{BGS} y \right&gt;_A
\]</div>
<p>Thus, a single forward (or single backward Gauss-Seidel) step is also convergenct:</p>
<div class="math notranslate nohighlight">
\[
\left&lt; M_{FGS} x, M_{FGS} x \right&gt;_A = \left&lt; M_{BGS} M_{FGS} x, x \right&gt;_A \leq \| M_{FBGS} \|_A \| x \|_A^2
\]</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./iterative"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="gradientmethod.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">33. </span>The Gradient Method</p>
      </div>
    </a>
    <a class="right-next"
       href="Chebyshev.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">36. </span>The Chebyshev Method</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">34. Preconditioning</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-preconditioned-richardson-iteration">34.1. The preconditioned Richardson iteration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-preconditioned-gradient-method">34.2. The preconditioned gradient method</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#jacobi-and-gauss-seidel-preconditioners">35. Jacobi and Gauss Seidel Preconditioners</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By J. Schöberl
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>